message "XML/PTDF/M30_V1.5.xsd" receiving, passthru
! message "XML/PHARMA/DTD/responseAPI.dtd" receiving, passthru

base "syslog.cfg" SYSLOG
base "documenttracker.cfg" TRACE

!===========================================================================================================

#define SYS_SOURCE_ID "PTDF"
#define CODACT "001"
#define VIRTUAL_SEPARATOR(A)	replace(build(number(A):R08.3),".","")	

#include "include/GEEXM30.inc"
 
#define _VERSION_ "1.0.0 01-07-2024"
#define LOG(LOG_label,LOG_value) log("* ",LOG_label:5.5," :",LOG_value,NL)
#define PRINT(LOG_label,LOG_value) print("* ",LOG_label:5.5," :",time ("%d.%m.%y %H:%M:%S")," :",LOG_value,NL)
#define PRINT_FATAL(A) PRINT("FATAL",A)
#define LOG_INFO(A) LOG("INFO",A)
#define LOG_FATAL(A) LOG("FATAL",A)
#define GET_CONF(A)	taPARAM[A]
#define PEEL(A)  peel(A," ")
#define REPLACE(A) replace(A, "\"", " ")

!===========================================================================================================
! Initialization section
begin
	nRec := 1
	nPos := 1
	nMessageID := cMessageID
	
    TRACE := new(build(sHOME,"/documenttracker"))

   	if (pINDEX) <> EMPTY then
		SYSLOG := find(sSYSLOG,INDEX=number(pINDEX))
	endif

    tInputFileName := pFTP.ORIGINAL.FILENAME
	if tInputFileName = EMPTY then
		tInputFileName := pEDISEND.ORIGINAL.NAME
	endif

    ! tNameFile := build("/tmp/DF0MA30",nMessageID,".DAT")
    ! tFileOut := build(sHOME, tNameFile)

	!Inicio do processo
		log("########################################################", NL)
		log("Inicio: ", time("now","%Y-%m-%d %H:%M:%S"), NL)
		log("Arquivo de entrada: ",tInputFileName, NL)
		log("########################################################", NL)

	!Variaveis Gerais
		nCount := 0

endbegin

!===========================================================================================================

! PRODUCT
	segment STRTEXC gGMESSAGE,gGPRODUCT
		nCount++
		taTRTEXC[nCount] := eETRTEXC
	endsegment

	segment SCODACT gGMESSAGE,gGPRODUCT
		taCODACT[nCount] := eECODACT
	endsegment

	segment SCODPRO gGMESSAGE,gGPRODUCT
		taCODPRO[nCount] := eECODPRO
	endsegment

	segment SVALPRO gGMESSAGE,gGPRODUCT
		taVALPRO[nCount] := eEVALPRO
	endsegment

	segment SDS1PRO gGMESSAGE,gGPRODUCT
		taDS1PRO[nCount] := eEDS1PRO
	endsegment

	segment SDS2PRO gGMESSAGE,gGPRODUCT
		taDS2PRO[nCount] := eEDS2PRO
	endsegment

	segment SFOUPRO gGMESSAGE,gGPRODUCT
		taFOUPRO[nCount] := eEFOUPRO
	endsegment

	segment SVAPPRO gGMESSAGE,gGPRODUCT
		taVAPPRO[nCount] := eEVAPPRO
	endsegment

	segment SFAMPRO gGMESSAGE,gGPRODUCT
		taFAMPRO[nCount] := eEFAMPRO
	endsegment

	segment SANAPRO gGMESSAGE,gGPRODUCT
		taANAPRO[nCount] := eEANAPRO
	endsegment

	segment SEDIPRO gGMESSAGE,gGPRODUCT
		taEDIPRO[nCount] := eEEDIPRO
	endsegment

	segment SSPCPRO gGMESSAGE,gGPRODUCT
		taSPCPRO[nCount] := eESPCPRO
	endsegment

	segment SPCBPRO gGMESSAGE,gGPRODUCT
		taPCBPRO[nCount] := eEPCBPRO
	endsegment

	segment SUNIPRO gGMESSAGE,gGPRODUCT
		taUNIPRO[nCount] := eEUNIPRO
	endsegment

	segment SMESPRO gGMESSAGE,gGPRODUCT
		taMESPRO[nCount] := eEMESPRO
	endsegment

	segment SPDBUVC gGMESSAGE,gGPRODUCT
		taPDBUVC[nCount] := eEPDBUVC
	endsegment

	segment SPDNUVC gGMESSAGE,gGPRODUCT
		taPDNUVC[nCount] := eEPDNUVC
	endsegment

	segment SHAUUVC gGMESSAGE,gGPRODUCT
		taHAUUVC[nCount] := eEHAUUVC
	endsegment

	segment SLNGUVC gGMESSAGE,gGPRODUCT
		taLNGUVC[nCount] := eELNGUVC
	endsegment

	segment SLRGUVC gGMESSAGE,gGPRODUCT
		taLRGUVC[nCount] := eELRGUVC
	endsegment

	segment SPDBCOL gGMESSAGE,gGPRODUCT
		taPDBCOL[nCount] := eEPDBCOL
	endsegment

	segment SHAUCOL gGMESSAGE,gGPRODUCT
		taHAUCOL[nCount] := eEHAUCOL
	endsegment

	segment SLNGCOL gGMESSAGE,gGPRODUCT
		taLNGCOL[nCount] := eELNGCOL
	endsegment

	segment SLRGCOL gGMESSAGE,gGPRODUCT
		taLRGCOL[nCount] := eELRGCOL
	endsegment

	segment SCOLCOU gGMESSAGE,gGPRODUCT
		taCOLCOU[nCount] := eECOLCOU
	endsegment

	segment SCOUPAL gGMESSAGE,gGPRODUCT
		taCOUPAL[nCount] := eECOUPAL
	endsegment

	segment SGERPAL gGMESSAGE,gGPRODUCT
		taGERPAL[nCount] := eEGERPAL
	endsegment

	segment SGERHAU gGMESSAGE,gGPRODUCT
		taGERHAU[nCount] := eEGERHAU
	endsegment

	segment SHAUCOU gGMESSAGE,gGPRODUCT
		taHAUCOU[nCount] := eEHAUCOU
	endsegment

	segment SCODEMB gGMESSAGE,gGPRODUCT
		taCODEMB[nCount] := eECODEMB
	endsegment

	segment SABCPRO gGMESSAGE,gGPRODUCT
		taABCPRO[nCount] := eEABCPRO
	endsegment

	segment SCODMDR gGMESSAGE,gGPRODUCT
		taCODMDR[nCount] := eECODMDR
	endsegment

	segment SMODREC gGMESSAGE,gGPRODUCT
		taMODREC[nCount] := eEMODREC
	endsegment

	segment SNBJDLV gGMESSAGE,gGPRODUCT
		taNBJDLV[nCount] := eENBJDLV
	endsegment

	segment SMOTIMM gGMESSAGE,gGPRODUCT
		taMOTIMM[nCount] := eEMOTIMM
	endsegment

	segment SCODMDS gGMESSAGE,gGPRODUCT
		taCODMDS[nCount] := eECODMDS
	endsegment

	segment SZONPRF gGMESSAGE,gGPRODUCT
		taZONPRF[nCount] := eEZONPRF
	endsegment

	segment SALLPRF gGMESSAGE,gGPRODUCT
		taALLPRF[nCount] := eEALLPRF
	endsegment

	segment SABCSTS gGMESSAGE,gGPRODUCT
		taABCSTS[nCount] := eEABCSTS
	endsegment

	segment SCODADM gGMESSAGE,gGPRODUCT
		taCODADM[nCount] := eECODADM
	endsegment

	segment SHOMGRB gGMESSAGE,gGPRODUCT
		taHOMGRB[nCount] := eEHOMGRB
	endsegment

	segment SPERGRB gGMESSAGE,gGPRODUCT
		taPERGRB[nCount] := eEPERGRB
	endsegment

	segment SCODMDP gGMESSAGE,gGPRODUCT
		taCODMDP[nCount] := eECODMDP
	endsegment

	segment STOPPRN gGMESSAGE,gGPRODUCT
		taTOPPRN[nCount] := eETOPPRN
	endsegment
! PRODUCT

! COMPLEMENT_01
	segment SCODACT gGMESSAGE,gGPRODUCT,gGCOMPLEMENT_01
		tCODACT := eECODACT
	endsegment

	segment SCODPRO gGMESSAGE,gGPRODUCT,gGCOMPLEMENT_01
		tCODPRO := eECODPRO
	endsegment

	segment SVALPRO gGMESSAGE,gGPRODUCT,gGCOMPLEMENT_01
		tVALPRO := eEVALPRO
	endsegment

	segment SINDPRO gGMESSAGE,gGPRODUCT,gGCOMPLEMENT_01
		tINDPRO := eEINDPRO
	endsegment

	segment SCODMRQ gGMESSAGE,gGPRODUCT,gGCOMPLEMENT_01
		tCODMRQ := eECODMRQ
	endsegment

	segment SDESFOU gGMESSAGE,gGPRODUCT,gGCOMPLEMENT_01
		tDESFOU := eEDESFOU
	endsegment

	segment SCIRDET gGMESSAGE,gGPRODUCT,gGCOMPLEMENT_01
		tCIRDET := eECIRDET
	endsegment

	segment SCIRPAL gGMESSAGE,gGPRODUCT,gGCOMPLEMENT_01
		tCIRPAL := eECIRPAL
	endsegment

	segment SMETRPL gGMESSAGE,gGPRODUCT,gGCOMPLEMENT_01
		tMETRPL := eEMETRPL
	endsegment

	segment SCODRPL gGMESSAGE,gGPRODUCT,gGCOMPLEMENT_01
		tCODRPL := eECODRPL
	endsegment

	segment SVALRPL gGMESSAGE,gGPRODUCT,gGCOMPLEMENT_01
		tVALRPL := eEVALRPL
	endsegment

	segment SCODALC gGMESSAGE,gGPRODUCT,gGCOMPLEMENT_01
		tCODALC := eECODALC
	endsegment

	segment SDEGALC gGMESSAGE,gGPRODUCT,gGCOMPLEMENT_01
		tDEGALC := eEDEGALC
	endsegment

	segment SVOLALC gGMESSAGE,gGPRODUCT,gGCOMPLEMENT_01
		tVOLALC := eEVOLALC
	endsegment

	segment SCODMDG gGMESSAGE,gGPRODUCT,gGCOMPLEMENT_01
		tCODMDG := eECODMDG
	endsegment

	segment STAUPST gGMESSAGE,gGPRODUCT,gGCOMPLEMENT_01
		tTAUPST := eETAUPST
	endsegment

	segment SCOELOG gGMESSAGE,gGPRODUCT,gGCOMPLEMENT_01
		tCOELOG := eECOELOG
	endsegment

	segment SPRXPRO gGMESSAGE,gGPRODUCT,gGCOMPLEMENT_01
		tPRXPRO := eEPRXPRO
	endsegment

	segment SCODMDI gGMESSAGE,gGPRODUCT,gGCOMPLEMENT_01
		tCODMDI := eECODMDI
	endsegment

	segment SNXTIVT gGMESSAGE,gGPRODUCT,gGCOMPLEMENT_01
		tNXTIVT := eENXTIVT
	endsegment

	segment SSECSTK gGMESSAGE,gGPRODUCT,gGCOMPLEMENT_01
		tSECSTK := eESECSTK
	endsegment

	segment SCODMDF gGMESSAGE,gGPRODUCT,gGCOMPLEMENT_01
		tCODMDF := eECODMDF
	endsegment

	segment SFMTFAB gGMESSAGE,gGPRODUCT,gGCOMPLEMENT_01
		tFMTFAB := eEFMTFAB
	endsegment

	segment SACTFAB gGMESSAGE,gGPRODUCT,gGCOMPLEMENT_01
		tACTFAB := eEACTFAB
	endsegment

	segment SCODFAB gGMESSAGE,gGPRODUCT,gGCOMPLEMENT_01
		tCODFAB := eECODFAB
	endsegment

	segment SVRAFAB gGMESSAGE,gGPRODUCT,gGCOMPLEMENT_01
		tVRAFAB := eEVRAFAB
	endsegment

	segment SVALFAB gGMESSAGE,gGPRODUCT,gGCOMPLEMENT_01
		tVALFAB := eEVALFAB
	endsegment

	segment SCODZVI gGMESSAGE,gGPRODUCT,gGCOMPLEMENT_01
		tCODZVI := eECODZVI
	endsegment

	segment SCODEAP gGMESSAGE,gGPRODUCT,gGCOMPLEMENT_01
		tCODEAP := eECODEAP
	endsegment

	segment STOPCNA gGMESSAGE,gGPRODUCT,gGCOMPLEMENT_01
		tTOPCNA := eETOPCNA
	endsegment
! COMPLEMENT_01

! COMPONENT
	segment SCODACT gGMESSAGE,gGPRODUCT,gGCOMPONENT
		tCODACT := eECODACT
	endsegment

	segment SCODPRN gGMESSAGE,gGPRODUCT,gGCOMPONENT
		tCODPRN := eECODPRN
	endsegment

	segment SCODPRO gGMESSAGE,gGPRODUCT,gGCOMPONENT
		tCODPRO := eECODPRO
	endsegment

	segment SVALPRO gGMESSAGE,gGPRODUCT,gGCOMPONENT
		tVALPRO := eEVALPRO
	endsegment

	segment SNBRCPS gGMESSAGE,gGPRODUCT,gGCOMPONENT
		tNBRCPS := eENBRCPS
	endsegment

	segment SACTCPS gGMESSAGE,gGPRODUCT,gGCOMPONENT
		tACTCPS := eEACTCPS
	endsegment

	segment SORDCPS gGMESSAGE,gGPRODUCT,gGCOMPONENT
		tORDCPS := eEORDCPS
	endsegment

	segment STYPCPS gGMESSAGE,gGPRODUCT,gGCOMPONENT
		tTYPCPS := eETYPCPS
	endsegment

	segment SDVSCPS gGMESSAGE,gGPRODUCT,gGCOMPONENT
		tDVSCPS := eEDVSCPS
	endsegment

	segment SUNIPRN gGMESSAGE,gGPRODUCT,gGCOMPONENT
		tUNIPRN := eEUNIPRN
	endsegment
! COMPONENT

! EAN
	segment SCODACT gGMESSAGE,gGPRODUCT,gGEAN
		tCODACT := eECODACT
	endsegment

	segment SCODPRO gGMESSAGE,gGPRODUCT,gGEAN
		tCODPRO := eECODPRO
	endsegment

	segment SVALPRO gGMESSAGE,gGPRODUCT,gGEAN
		tVALPRO := eEVALPRO
	endsegment

	segment SDS1PRO gGMESSAGE,gGPRODUCT,gGEAN
		tDS1PRO := eEDS1PRO
	endsegment

	segment SEDIPRO gGMESSAGE,gGPRODUCT,gGEAN
		tEDIPRO := eEEDIPRO
	endsegment

	segment SEANDS1 gGMESSAGE,gGPRODUCT,gGEAN
		tEANDS1 := eEEANDS1
	endsegment

	segment SEDIPRM gGMESSAGE,gGPRODUCT,gGEAN
		tEDIPRM := eEEDIPRM
	endsegment

	segment SEDIQLF gGMESSAGE,gGPRODUCT,gGEAN
		tEDIQLF := eEEDIQLF
	endsegment

	segment SEANVTE gGMESSAGE,gGPRODUCT,gGEAN
		tEANVTE := eEEANVTE
	endsegment
! EAN

! LANGUAGE
	segment SCODLGE gGMESSAGE,gGPRODUCT,gGLANGUAGE
		tCODLGE := eECODLGE
	endsegment

	segment SDS1PRO gGMESSAGE,gGPRODUCT,gGLANGUAGE
		tDS1PRO := eEDS1PRO
	endsegment

	segment SDS2PRO gGMESSAGE,gGPRODUCT,gGLANGUAGE
		tDS2PRO := eEDS2PRO
	endsegment

	segment SDESPRO gGMESSAGE,gGPRODUCT,gGLANGUAGE
		tDESPRO := eEDESPRO
	endsegment

! LANGUAGE

!===========================================================================================================
! Default statements section
default

enddefault

!===========================================================================================================
! End statements section
end
    log("tTRTEXC = ", tTRTEXC, NL)
    log("tCODPRO = ", tCODPRO, NL)

	! 00.00
		R_GEEX0000_CODEXC(00)
		R_GEEX0000_SEPEXC(".")
		R_GEEX0000_SCOEXC(00)
		!R_GEEX0000_TRTEXC(A)
		R_GEEX0000_EMTEXC("PTDF")
		!R_GEEX0000_RCTEXC(A)
		R_GEEX0000_DATEXC(time("now" ,"%Y%m%d"))
		R_GEEX0000_HEUEXC(time("now" ,"%H%M%S"))
		!R_GEEX0000_NUMEXC(A)
		!R_GEEX0000_ACQEXC(A)
		!R_GEEX0000_VEREXC(A)
		!R_GEEX0000_NOMSYS(A)
		!R_GEEX0000_NOMDTQ(A)
		!R_GEEX0000_BIBDTQ(A)
		!R_GEEX0000_LIBEXC(A)
		!R_GEEX0000_BIBDST(A)
		!R_GEEX0000_PGMDST(A)
		!R_GEEX0000_PARDST(A)
		!R_GEEX0000_CODACT(A)
		!R_GEEX0000_IGLSIT(A)
		!R_GEEX0000_EDISIT(A)
		!R_GEEX0000_IMAEXC(A)
		!R_GEEX0000_IDEMSG(A)
		!R_GEEX0000_NATEXC(A)
		!R_GEEX0000_EMTORI(A)
		!R_GEEX0000_DISEXC(A)

	! 00.00

	while tIndex in taTRTEXC do

		! 30.00
			R_GEEX3000_CODEXC(30)
			R_GEEX3000_SEPEXC(".")
			R_GEEX3000_SCOEXC(00)
			R_GEEX3000_TRTEXC(taTRTEXC[tIndex])
			R_GEEX3000_CODACT(taCODACT[tIndex])
			R_GEEX3000_CODPRO(taCODPRO[tIndex])
			R_GEEX3000_VALPRO(taVALPRO[tIndex])
			R_GEEX3000_DS1PRO(taDS1PRO[tIndex])
			R_GEEX3000_DS2PRO(taDS2PRO[tIndex])
			R_GEEX3000_FOUPRO(taFOUPRO[tIndex])
			R_GEEX3000_VAPPRO(taVAPPRO[tIndex])
			R_GEEX3000_FAMPRO(taFAMPRO[tIndex])
			R_GEEX3000_ANAPRO(taANAPRO[tIndex])
			R_GEEX3000_EDIPRO(taEDIPRO[tIndex])
			R_GEEX3000_SPCPRO(taSPCPRO[tIndex])
			R_GEEX3000_PCBPRO(taPCBPRO[tIndex])
			R_GEEX3000_UNIPRO(taUNIPRO[tIndex])
			R_GEEX3000_MESPRO(taMESPRO[tIndex])
			R_GEEX3000_PDBUVC(taPDBUVC[tIndex])
			R_GEEX3000_PDNUVC(taPDNUVC[tIndex])
			R_GEEX3000_HAUUVC(taHAUUVC[tIndex])
			R_GEEX3000_LNGUVC(taLNGUVC[tIndex])
			R_GEEX3000_LRGUVC(taLRGUVC[tIndex])
			R_GEEX3000_PDBCOL(taPDBCOL[tIndex])
			R_GEEX3000_HAUCOL(taHAUCOL[tIndex])
			R_GEEX3000_LNGCOL(taLNGCOL[tIndex])
			R_GEEX3000_LRGCOL(taLRGCOL[tIndex])
			R_GEEX3000_COLCOU(taCOLCOU[tIndex])
			R_GEEX3000_COUPAL(taCOUPAL[tIndex])
			R_GEEX3000_GERPAL(taGERPAL[tIndex])
			R_GEEX3000_GERHAU(taGERHAU[tIndex])
			R_GEEX3000_HAUCOU(taHAUCOU[tIndex])
			R_GEEX3000_CODEMB(taCODEMB[tIndex])
			R_GEEX3000_ABCPRO(taABCPRO[tIndex])
			R_GEEX3000_CODMDR(taCODMDR[tIndex])
			R_GEEX3000_MODREC(taMODREC[tIndex])
			R_GEEX3000_NBJDLV(taNBJDLV[tIndex])
			R_GEEX3000_MOTIMM(taMOTIMM[tIndex])
			R_GEEX3000_CODMDS(taCODMDS[tIndex])
			R_GEEX3000_ZONPRF(taZONPRF[tIndex])
			R_GEEX3000_ALLPRF(taALLPRF[tIndex])
			R_GEEX3000_ABCSTS(taABCSTS[tIndex])
			R_GEEX3000_CODADM(taCODADM[tIndex])
			R_GEEX3000_HOMGRB(taHOMGRB[tIndex])
			R_GEEX3000_PERGRB(taPERGRB[tIndex])
			R_GEEX3000_CODMDP(taCODMDP[tIndex])
			R_GEEX3000_TOPPRN(taTOPPRN[tIndex])
			!R_GEEX3000_ORIMAJ(taORIMAJ[tIndex])
			!R_GEEX3000_TOPPRO(taTOPPRO[tIndex])

		! 30.00

		! 30.01
			R_GEEX3001_CODEXC(30)
			R_GEEX3001_SEPEXC(".")
			R_GEEX3001_SCOEXC(01)
			R_GEEX3001_TRTEXC(taTRTEXC[tIndex])
			R_GEEX3001_CODACT(taCODACT[tIndex])
			R_GEEX3001_CODPRO(taCODPRO[tIndex])
			R_GEEX3001_VALPRO(taVALPRO[tIndex])
			R_GEEX3001_INDPRO(taINDPRO[tIndex])
			R_GEEX3001_CODMRQ(taCODMRQ[tIndex])
			R_GEEX3001_DESFOU(taDESFOU[tIndex])
			R_GEEX3001_CIRDET(taCIRDET[tIndex])
			R_GEEX3001_CIRPAL(taCIRPAL[tIndex])
			R_GEEX3001_METRPL(taMETRPL[tIndex])
			R_GEEX3001_CODRPL(taCODRPL[tIndex])
			R_GEEX3001_VALRPL(taVALRPL[tIndex])
			R_GEEX3001_CODALC(taCODALC[tIndex])
			R_GEEX3001_DEGALC(taDEGALC[tIndex])
			R_GEEX3001_VOLALC(taVOLALC[tIndex])
			R_GEEX3001_CODMDG(taCODMDG[tIndex])
			R_GEEX3001_TAUPST(taTAUPST[tIndex])
			R_GEEX3001_COELOG(taCOELOG[tIndex])
			R_GEEX3001_PRXPRO(taPRXPRO[tIndex])
			R_GEEX3001_CODMDI(taCODMDI[tIndex])
			R_GEEX3001_NXTIVT(taNXTIVT[tIndex])
			R_GEEX3001_SECSTK(taSECSTK[tIndex])
			R_GEEX3001_CODMDF(taCODMDF[tIndex])
			R_GEEX3001_FMTFAB(taFMTFAB[tIndex])
			R_GEEX3001_ACTFAB(taACTFAB[tIndex])
			R_GEEX3001_CODFAB(taCODFAB[tIndex])
			R_GEEX3001_VRAFAB(taVRAFAB[tIndex])
			R_GEEX3001_VALFAB(taVALFAB[tIndex])
			R_GEEX3001_CODZVI(taCODZVI[tIndex])
			R_GEEX3001_CODEAP(taCODEAP[tIndex])
			R_GEEX3001_TOPCNA(taTOPCNA[tIndex])

		! 30.01

		while taIndexLinha in taNLIREC do
			if naCountLinha[taIndexLinha] = number(tIndex) then
				! 30.20 
					R_GEEX3020_CODEXC(30)
					R_GEEX3020_SEPEXC(".")
					R_GEEX3020_SCOEXC(20)
					R_GEEX3020_TRTEXC(taTRTEXC[taIndexLinha])
					R_GEEX3020_CODACT(taCODACT[taIndexLinha])
					R_GEEX3020_CODPRO(taCODPRO[taIndexLinha])
					R_GEEX3020_VALPRO(taVALPRO[taIndexLinha])
					R_GEEX3020_DS1PRO(taDS1PRO[taIndexLinha])
					R_GEEX3020_EDIPRO(taEDIPRO[taIndexLinha])
					R_GEEX3020_EANDS1(taEANDS1[taIndexLinha])
					R_GEEX3020_EDIPRM(taEDIPRM[taIndexLinha])
					R_GEEX3020_EDIQLF(taEDIQLF[taIndexLinha])
					R_GEEX3020_EANVTE(taEANVTE[taIndexLinha])
					!R_GEEX3020_DISEXC(taDISEXC[taIndexLinha])

				! 30.20
			endif
		endwhile

		! 30.30
			R_GEEX3030_CODEXC(30)
			R_GEEX3030_SEPEXC(".")
			R_GEEX3030_SCOEXC(30)
			R_GEEX3030_TRTEXC(taTRTEXC[tIndex])
			R_GEEX3030_CODACT(taCODACT[tIndex])
			R_GEEX3030_CODPRO(taCODPRO[tIndex])
			R_GEEX3030_VALPRO(taVALPRO[tIndex])
			R_GEEX3030_CODLGE(taCODLGE[tIndex])
			R_GEEX3030_DS1PRO(taDS1PRO[tIndex])
			R_GEEX3030_DS2PRO(taDS2PRO[tIndex])
			R_GEEX3030_DESPRO(taDESPRO[tIndex])
			!R_GEEX3030_DISEXC(A)
		! 30.30

	endwhile

	! 99.00
		R_GEEX9900_CODEXC(99)
		R_GEEX9900_SEPEXC(".")
		R_GEEX9900_SCOEXC(00)
		!R_GEEX9900_TRTEXC(A)
		R_GEEX9900_EMTEXC("PTDF")
		!R_GEEX9900_RCTEXC(A)
		R_GEEX9900_DATEXC(time("now" ,"%Y%m%d"))
		R_GEEX9900_HEUEXC(time("now" ,"%H%M%S"))
		R_GEEX9900_NUMEXC(build(nCount:R08.0))
		!R_GEEX9900_CPTEXC(A)
		!R_GEEX9900_NOMSYS(A)
		!R_GEEX9900_NOMDTQ(A)
		!R_GEEX9900_BIBDTQ(A)
		!R_GEEX9900_IDEMSG(A)
		!R_GEEX9900_DISEXC(A)
	! 99.00

	log("########################################################", NL)
	log("Fim: ", time("now","%Y-%m-%d %H:%M:%S"), NL)
	log("########################################################", NL)

endend

!===========================================================================================================
