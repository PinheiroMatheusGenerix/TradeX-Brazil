%@(#)  M59_MARS_CJ_BYPASS.rte     modif:02-05-2023
!==============================================================================
% File          : M59_MARS_CJ_BYPASS.rte   version 1.0.0
!------------------------------------------------------------------------------
% Description   : <short program description>
!------------------------------------------------------------------------------
% Author        : Richard - Generix BR
!==============================================================================
! 02-05-2023  XX  Creation / Copy
! 18-09-2018  XX  <comments>
!==============================================================================
!
! <detailed program description>
!
!==============================================================================
! input file     : <name or rule for naming input file>
! output file    : <name or rule for naming output file> 
! temporary file : <name or rule for naming temporary file> 
!==============================================================================

!base "syslog.cfg" SYSLOG 
base "../trace/trace.cfg" TRACE,autoflush off

!==============================================================================

! Input/output macros file
#define TX_PROG_INFO "M59_MARS_CJ_BYPASS"
#include "include/generix_func.inc"
#include "include/GEEXM59.inc"
#include "include/GEEXM59_BYPASS.inc"

!==============================================================================

! Initialization section

begin
	SYSLOG := find(sSYSLOG,INDEX=number(pINDEX))
	nPos := 1
	nRec := 1
	nMessageID := cMessageID

	load(0, build(sHOME,"/config/FM_wms_configuration.properties"), taPARAM)
	tToInfologPrefixFilename := taPARAM["ToInfologPrefixFilenameCJM"]

	tDbBase		:= "FMWMS"
	tDbUsername	:= taPARAM["WMSDBUSER"]
	tDbPassword	:= taPARAM["WMSDBPASS"]
	tDbUrl		:= taPARAM["WMSDBURL"]

	bfSqlInit()
	if not bfSqlJdbc(tDbBase , tDbUsername, tDbPassword, tDbUrl) then
		print("FATAL ",tfSqlErrorStr())
		bfSqlClose(tDbBase)
		bfMajtraceBP("Erro de Traducao","1",tNumeroDocumento,tDataDocumento,tFileOut,"M59 - BYPASS",build("Erro na abertura do banco de dados: ",tfSqlErrorStr()))
		exit(1)
	endif
	
	tFileOutBP := build(sHOME,"/mdn/auto/FM",tToInfologPrefixFilename,"MAC_M59",time("now","%Y%m%d%H%M%S"),substr(build(nMessageID), length(build(nMessageID)) - 1, 2),".DAT")
    tFileOutTempBP := build(sHOME,"/mdn/auto/Temp/FM",tToInfologPrefixFilename,"MAC_M59",time("now","%Y%m%d%H%M%S"),substr(build(nMessageID), length(build(nMessageID)) - 1, 2),".DAT")
    tNameOutBP := build("FM",tToInfologPrefixFilename,"MAC_M59",time("now","%Y%m%d%H%M%S"),substr(build(nMessageID), length(build(nMessageID)) - 1, 2),".DAT")

endbegin

!==============================================================================

line(1:"00.00")
    tCODACT := S_GEEX0000_CODACT

    ! MASSIFICACAO INICIO
        ! CAMPOS WMS
            tCODEXC0000_MASSIF_Line := S_GEEX0000_BP_CODEXC
            tSEPEXC0000_MASSIF_Line := S_GEEX0000_BP_SEPEXC
            tSCOEXC0000_MASSIF_Line := S_GEEX0000_BP_SCOEXC
            tTRTEXC0000_MASSIF_Line := S_GEEX0000_BP_TRTEXC
            tEMTEXC0000_MASSIF_Line := S_GEEX0000_BP_EMTEXC
            tRCTEXC0000_MASSIF_Line := S_GEEX0000_BP_RCTEXC
            tDATEXC0000_MASSIF_Line := S_GEEX0000_BP_DATEXC
            tHEUEXC0000_MASSIF_Line := S_GEEX0000_BP_HEUEXC
            tNUMEXC0000_MASSIF_Line := S_GEEX0000_BP_NUMEXC
            tACQEXC0000_MASSIF_Line := S_GEEX0000_BP_ACQEXC
            tVEREXC0000_MASSIF_Line := S_GEEX0000_BP_VEREXC
            tNOMSYS0000_MASSIF_Line := S_GEEX0000_BP_NOMSYS
            tNOMDTQ0000_MASSIF_Line := S_GEEX0000_BP_NOMDTQ
            tBIBDTQ0000_MASSIF_Line := S_GEEX0000_BP_BIBDTQ
            tLIBEXC0000_MASSIF_Line := S_GEEX0000_BP_LIBEXC
            tBIBDST0000_MASSIF_Line := S_GEEX0000_BP_BIBDST
            tPGMDST0000_MASSIF_Line := S_GEEX0000_BP_PGMDST
            tPARDST0000_MASSIF_Line := S_GEEX0000_BP_PARDST
            tCODACT0000_MASSIF_Line := S_GEEX0000_BP_CODACT
            tIGLSIT0000_MASSIF_Line := S_GEEX0000_BP_IGLSIT
            tEDISIT0000_MASSIF_Line := S_GEEX0000_BP_EDISIT
            tIMAEXC0000_MASSIF_Line := S_GEEX0000_BP_IMAEXC
            tIDEMSG0000_MASSIF_Line := S_GEEX0000_BP_IDEMSG
            tNATEXC0000_MASSIF_Line := S_GEEX0000_BP_NATEXC
            tEMTORI0000_MASSIF_Line := S_GEEX0000_BP_EMTORI
            tDISEXC0000_MASSIF_Line := S_GEEX0000_BP_DISEXC
        ! FIM CAMPOS WMS
    ! MASSIFICACAO FINAL

	!BYPASS INICIO
		R_GEEX0000_CODEXC(S_GEEX0000_BP_CODEXC)
		R_GEEX0000_SEPEXC(S_GEEX0000_BP_SEPEXC)
		R_GEEX0000_SCOEXC(S_GEEX0000_BP_SCOEXC)
		R_GEEX0000_TRTEXC(S_GEEX0000_BP_TRTEXC)
		R_GEEX0000_EMTEXC(S_GEEX0000_BP_EMTEXC)
		R_GEEX0000_RCTEXC(S_GEEX0000_BP_RCTEXC)
		R_GEEX0000_DATEXC(S_GEEX0000_BP_DATEXC)
		R_GEEX0000_HEUEXC(S_GEEX0000_BP_HEUEXC)
		R_GEEX0000_NUMEXC(S_GEEX0000_BP_NUMEXC)
		R_GEEX0000_ACQEXC(S_GEEX0000_BP_ACQEXC)
		R_GEEX0000_VEREXC(S_GEEX0000_BP_VEREXC)
		R_GEEX0000_NOMSYS(S_GEEX0000_BP_NOMSYS)
		R_GEEX0000_NOMDTQ(S_GEEX0000_BP_NOMDTQ)
		R_GEEX0000_BIBDTQ(S_GEEX0000_BP_BIBDTQ)
		R_GEEX0000_LIBEXC(S_GEEX0000_BP_LIBEXC)
		R_GEEX0000_BIBDST(S_GEEX0000_BP_BIBDST)
		R_GEEX0000_PGMDST(S_GEEX0000_BP_PGMDST)
		R_GEEX0000_PARDST(S_GEEX0000_BP_PARDST)
		R_GEEX0000_CODACT(S_GEEX0000_BP_CODACT)
		R_GEEX0000_IGLSIT(S_GEEX0000_BP_IGLSIT)
		R_GEEX0000_EDISIT(S_GEEX0000_BP_EDISIT)
		R_GEEX0000_IMAEXC(S_GEEX0000_BP_IMAEXC)
		R_GEEX0000_IDEMSG(S_GEEX0000_BP_IDEMSG)
		R_GEEX0000_NATEXC(S_GEEX0000_BP_NATEXC)
		R_GEEX0000_EMTORI(S_GEEX0000_BP_EMTORI)
		R_GEEX0000_DISEXC(S_GEEX0000_BP_DISEXC)
		
		flush(0,0,NL) >> tFileOutTempBP
	!BYPASS FINAL
endline

!==============================================================================

line(1:"59.10")
	!BYPASS INICIO
        R_GEEX5910_BP_CODEXC(S_GEEX5910_CODEXC)
        R_GEEX5910_BP_SEPEXC(S_GEEX5910_SEPEXC)
        R_GEEX5910_BP_SCOEXC(S_GEEX5910_SCOEXC)
        R_GEEX5910_BP_TRTEXC(S_GEEX5910_TRTEXC)
        R_GEEX5910_BP_NUMTOU(S_GEEX5910_NUMTOU)
        R_GEEX5910_BP_ORDLIV(S_GEEX5910_ORDLIV)
        R_GEEX5910_BP_NUMLIV(S_GEEX5910_NUMLIV)
        R_GEEX5910_BP_SNULIV(S_GEEX5910_SNULIV)
        R_GEEX5910_BP_ETALIV(S_GEEX5910_ETALIV)
        R_GEEX5910_BP_DATLIV(S_GEEX5910_DATLIV)
        R_GEEX5910_BP_DATPRP(S_GEEX5910_DATPRP)
        R_GEEX5910_BP_NUMVAG(S_GEEX5910_NUMVAG)
        R_GEEX5910_BP_ORICDE(S_GEEX5910_ORICDE)
        R_GEEX5910_BP_TOPLIV(S_GEEX5910_TOPLIV)
        R_GEEX5910_BP_CODACT(S_GEEX5910_CODACT)
        R_GEEX5910_BP_CODCLI(S_GEEX5910_CODCLI)
        R_GEEX5910_BP_TYPCLI(S_GEEX5910_TYPCLI)
        R_GEEX5910_BP_CATCLI(S_GEEX5910_CATCLI)
        R_GEEX5910_BP_CODMOP(S_GEEX5910_CODMOP)
        R_GEEX5910_BP_CLILIV(S_GEEX5910_CLILIV)
        R_GEEX5910_BP_NOMCLI(S_GEEX5910_NOMCLI)
        R_GEEX5910_BP_AD1CLI(S_GEEX5910_AD1CLI)
        R_GEEX5910_BP_AD2CLI(S_GEEX5910_AD2CLI)
        R_GEEX5910_BP_CPOCLI(S_GEEX5910_CPOCLI)
        R_GEEX5910_BP_VILCLI(S_GEEX5910_VILCLI)
        R_GEEX5910_BP_PAYCLI(S_GEEX5910_PAYCLI)
        R_GEEX5910_BP_CODRGT(S_GEEX5910_CODRGT)
        R_GEEX5910_BP_TELCLI(S_GEEX5910_TELCLI)
        R_GEEX5910_BP_CPICLI(S_GEEX5910_CPICLI)
		
		flush(0,0,NL) >> tFileOutTempBP
	!BYPASS FINAL
endline

!==============================================================================

line(1:"59.11")
	!BYPASS INICIO
        R_GEEX5911_BP_CODEXC(S_GEEX5911_CODEXC)
        R_GEEX5911_BP_SEPEXC(S_GEEX5911_SEPEXC)
        R_GEEX5911_BP_SCOEXC(S_GEEX5911_SCOEXC)
        R_GEEX5911_BP_TRTEXC(S_GEEX5911_TRTEXC)
        R_GEEX5911_BP_FAXCLI(S_GEEX5911_FAXCLI)
        R_GEEX5911_BP_TLXCLI(S_GEEX5911_TLXCLI)
        R_GEEX5911_BP_CODTRA(S_GEEX5911_CODTRA)
        R_GEEX5911_BP_TYPTRA(S_GEEX5911_TYPTRA)
        R_GEEX5911_BP_NOMTRA(S_GEEX5911_NOMTRA)
        R_GEEX5911_BP_REFLIV(S_GEEX5911_REFLIV)
        R_GEEX5911_BP_TYPLIV(S_GEEX5911_TYPLIV)
        R_GEEX5911_BP_KAILIV(S_GEEX5911_KAILIV)
        R_GEEX5911_BP_DTILIV(S_GEEX5911_DTILIV)
        R_GEEX5911_BP_HEILIV(S_GEEX5911_HEILIV)
        R_GEEX5911_BP_HEULIV(S_GEEX5911_HEULIV)
        R_GEEX5911_BP_MSGPRP(S_GEEX5911_MSGPRP)
        R_GEEX5911_BP_CUMPOI(S_GEEX5911_CUMPOI)
        R_GEEX5911_BP_CUMVOL(S_GEEX5911_CUMVOL)
        R_GEEX5911_BP_CUMCOL(S_GEEX5911_CUMCOL)
        R_GEEX5911_BP_CUMLIG(S_GEEX5911_CUMLIG)
        R_GEEX5911_BP_CUMPRD(S_GEEX5911_CUMPRD)
        R_GEEX5911_BP_CUMPRP(S_GEEX5911_CUMPRP)
        R_GEEX5911_BP_DISEXC(S_GEEX5911_DISEXC)
		
		flush(0,0,NL) >> tFileOutTempBP
	!BYPASS FINAL
endline

!==============================================================================

line(1:"59.20")       
    bGeraByPASS := FALSE
    bGeraMassificacao := FALSE
    
    log("------------------------------------------------------------", NL)
    log("CLILIV: ",S_GEEX5920_CLILIV, NL)
    log("TYPSUP: ",S_GEEX5920_TYPSUP, NL)
    log("ETASUP: ",S_GEEX5920_ETASUP, NL)
    log("TRTEXC: ",S_GEEX5920_TRTEXC, NL)
    log("------------------------------------------------------------", NL)

    if S_GEEX5920_ETASUP <> "30" or S_GEEX5920_TRTEXC = "9" then
        close(tFileOutBP)
        close(tFileOutTempBP)
        remove(tFileOutBP)
        remove(tFileOutTempBP)
        close(tDbBase)
        log("Não gerou nada pois o ETASUP(",S_GEEX5920_ETASUP,") <> 30 ou TRTEXC(",S_GEEX5920_TRTEXC,") = 9.", NL)
        exit(1)
    else
        if S_GEEX5920_CLILIV <> "MASSIFICATION" and S_GEEX5920_TYPSUP = "1" and tCODACT = "MAC" then
            bGeraByPASS := TRUE
        else
            if S_GEEX5920_CLILIV = "MASSIFICATION" then
                bGeraMassificacao := TRUE
                taNUMSUP_MASSIF[S_GEEX5920_CLILIV] := S_GEEX5920_NUMSUP
                tNUMSUP_5920 := S_GEEX5920_NUMSUP
            else
                close(tFileOutBP)
                close(tFileOutTempBP)
                remove(tFileOutBP)
                remove(tFileOutTempBP)
                close(tDbBase)
                log("Não gerar M59.", NL)
                exit(1)
            endif
        endif
    endif

    ! MASSIFICACAO INICIO
        ! CAMPOS WMS
            taCODEXC5920_MASSIF_Line[S_GEEX5920_NUMSUP] := S_GEEX5920_CODEXC
            taSEPEXC5920_MASSIF_Line[S_GEEX5920_NUMSUP] := S_GEEX5920_SEPEXC
            taSCOEXC5920_MASSIF_Line[S_GEEX5920_NUMSUP] := S_GEEX5920_SCOEXC
            taTRTEXC5920_MASSIF_Line[S_GEEX5920_NUMSUP] := S_GEEX5920_TRTEXC
            taNUMSUP5920_MASSIF_Line[S_GEEX5920_NUMSUP] := S_GEEX5920_NUMSUP
            taSNUSUP5920_MASSIF_Line[S_GEEX5920_NUMSUP] := S_GEEX5920_SNUSUP
            taTYPSUP5920_MASSIF_Line[S_GEEX5920_NUMSUP] := S_GEEX5920_TYPSUP
            taETASUP5920_MASSIF_Line[S_GEEX5920_NUMSUP] := S_GEEX5920_ETASUP
            taLIBSUP5920_MASSIF_Line[S_GEEX5920_NUMSUP] := S_GEEX5920_LIBSUP
            taCODEMB5920_MASSIF_Line[S_GEEX5920_NUMSUP] := S_GEEX5920_CODEMB
            taCODUOP5920_MASSIF_Line[S_GEEX5920_NUMSUP] := S_GEEX5920_CODUOP
            taEMBUOP5920_MASSIF_Line[S_GEEX5920_NUMSUP] := S_GEEX5920_EMBUOP
            taEMBTOU5920_MASSIF_Line[S_GEEX5920_NUMSUP] := S_GEEX5920_EMBTOU
            taTOPBDL5920_MASSIF_Line[S_GEEX5920_NUMSUP] := S_GEEX5920_TOPBDL
            taAIGALC5920_MASSIF_Line[S_GEEX5920_NUMSUP] := S_GEEX5920_AIGALC
            taAIGPRI5920_MASSIF_Line[S_GEEX5920_NUMSUP] := S_GEEX5920_AIGPRI
            taAIGPVA5920_MASSIF_Line[S_GEEX5920_NUMSUP] := S_GEEX5920_AIGPVA
            taNBRPVA5920_MASSIF_Line[S_GEEX5920_NUMSUP] := S_GEEX5920_NBRPVA
            taDATPRP5920_MASSIF_Line[S_GEEX5920_NUMSUP] := S_GEEX5920_DATPRP
            taNUMVAG5920_MASSIF_Line[S_GEEX5920_NUMSUP] := S_GEEX5920_NUMVAG
            taNUMTOU5920_MASSIF_Line[S_GEEX5920_NUMSUP] := S_GEEX5920_NUMTOU
            taDATLIV5920_MASSIF_Line[S_GEEX5920_NUMSUP] := S_GEEX5920_DATLIV
            taTOULIV5920_MASSIF_Line[S_GEEX5920_NUMSUP] := S_GEEX5920_TOULIV
            taNSTLIV5920_MASSIF_Line[S_GEEX5920_NUMSUP] := S_GEEX5920_NSTLIV
            taORDLIV5920_MASSIF_Line[S_GEEX5920_NUMSUP] := S_GEEX5920_ORDLIV
            taKAILIV5920_MASSIF_Line[S_GEEX5920_NUMSUP] := S_GEEX5920_KAILIV
            taNUMLIV5920_MASSIF_Line[S_GEEX5920_NUMSUP] := S_GEEX5920_NUMLIV
            taSNULIV5920_MASSIF_Line[S_GEEX5920_NUMSUP] := S_GEEX5920_SNULIV
            taCODACL5920_MASSIF_Line[S_GEEX5920_NUMSUP] := S_GEEX5920_CODACL
            taREFLIV5920_MASSIF_Line[S_GEEX5920_NUMSUP] := S_GEEX5920_REFLIV
            taORICDE5920_MASSIF_Line[S_GEEX5920_NUMSUP] := S_GEEX5920_ORICDE
            taCLILIV5920_MASSIF_Line[S_GEEX5920_NUMSUP] := S_GEEX5920_CLILIV
            taNOMCLI5920_MASSIF_Line[S_GEEX5920_NUMSUP] := S_GEEX5920_NOMCLI
            taCUMPOI5920_MASSIF_Line[S_GEEX5920_NUMSUP] := S_GEEX5920_CUMPOI
            taCUMVOL5920_MASSIF_Line[S_GEEX5920_NUMSUP] := S_GEEX5920_CUMVOL
            taCUMCOL5920_MASSIF_Line[S_GEEX5920_NUMSUP] := S_GEEX5920_CUMCOL
            taCUMLIG5920_MASSIF_Line[S_GEEX5920_NUMSUP] := S_GEEX5920_CUMLIG
            taCUMPRT5920_MASSIF_Line[S_GEEX5920_NUMSUP] := S_GEEX5920_CUMPRT
            taCUMEQP5920_MASSIF_Line[S_GEEX5920_NUMSUP] := S_GEEX5920_CUMEQP
            taDISEXC5920_MASSIF_Line[S_GEEX5920_NUMSUP] := S_GEEX5920_DISEXC            
        ! FIM CAMPOS WMS
    ! MASSIFICACAO FINAL

	!BYPASS INICIO
        R_GEEX5920_BP_CODEXC(S_GEEX5920_CODEXC)
        R_GEEX5920_BP_SEPEXC(S_GEEX5920_SEPEXC)
        R_GEEX5920_BP_SCOEXC(S_GEEX5920_SCOEXC)
        R_GEEX5920_BP_TRTEXC(S_GEEX5920_TRTEXC)
        R_GEEX5920_BP_NUMSUP(S_GEEX5920_NUMSUP)
        R_GEEX5920_BP_SNUSUP(S_GEEX5920_SNUSUP)
        R_GEEX5920_BP_TYPSUP(S_GEEX5920_TYPSUP)
        R_GEEX5920_BP_ETASUP(S_GEEX5920_ETASUP)
        R_GEEX5920_BP_LIBSUP(S_GEEX5920_LIBSUP)
        R_GEEX5920_BP_CODEMB(S_GEEX5920_CODEMB)
        R_GEEX5920_BP_CODUOP(S_GEEX5920_CODUOP)
        R_GEEX5920_BP_EMBUOP(S_GEEX5920_EMBUOP)
        R_GEEX5920_BP_EMBTOU(S_GEEX5920_EMBTOU)
        R_GEEX5920_BP_TOPBDL(S_GEEX5920_TOPBDL)
        R_GEEX5920_BP_AIGALC(S_GEEX5920_AIGALC)
        R_GEEX5920_BP_AIGPRI(S_GEEX5920_AIGPRI)
        R_GEEX5920_BP_AIGPVA(S_GEEX5920_AIGPVA)
        R_GEEX5920_BP_NBRPVA(S_GEEX5920_NBRPVA)
        R_GEEX5920_BP_DATPRP(S_GEEX5920_DATPRP)
        R_GEEX5920_BP_NUMVAG(S_GEEX5920_NUMVAG)
        R_GEEX5920_BP_NUMTOU(S_GEEX5920_NUMTOU)
        R_GEEX5920_BP_DATLIV(S_GEEX5920_DATLIV)
        R_GEEX5920_BP_TOULIV(S_GEEX5920_TOULIV)
        R_GEEX5920_BP_NSTLIV(S_GEEX5920_NSTLIV)
        R_GEEX5920_BP_ORDLIV(S_GEEX5920_ORDLIV)
        R_GEEX5920_BP_KAILIV(S_GEEX5920_KAILIV)
        R_GEEX5920_BP_NUMLIV(S_GEEX5920_NUMLIV)
        R_GEEX5920_BP_SNULIV(S_GEEX5920_SNULIV)
        R_GEEX5920_BP_CODACL(S_GEEX5920_CODACL)
        R_GEEX5920_BP_REFLIV(S_GEEX5920_REFLIV)
        R_GEEX5920_BP_ORICDE(S_GEEX5920_ORICDE)
        R_GEEX5920_BP_CLILIV(S_GEEX5920_CLILIV)
        R_GEEX5920_BP_NOMCLI(S_GEEX5920_NOMCLI)
        R_GEEX5920_BP_CUMPOI(S_GEEX5920_CUMPOI)
        R_GEEX5920_BP_CUMVOL(S_GEEX5920_CUMVOL)
        R_GEEX5920_BP_CUMCOL(S_GEEX5920_CUMCOL)
        R_GEEX5920_BP_CUMLIG(S_GEEX5920_CUMLIG)
        R_GEEX5920_BP_CUMPRT(S_GEEX5920_CUMPRT)
        R_GEEX5920_BP_CUMEQP(S_GEEX5920_CUMEQP)
        R_GEEX5920_BP_DISEXC(S_GEEX5920_DISEXC)
		
		flush(0,0,NL) >> tFileOutTempBP
	!BYPASS FINAL
endline

!==============================================================================

line(1:"59.21")
    ! MASSIFICACAO INICIO
        ! CAMPOS WMS
            taCODEXC5921_MASSIF_Line[tNUMSUP_5920] := S_GEEX5921_CODEXC
            taSEPEXC5921_MASSIF_Line[tNUMSUP_5920] := S_GEEX5921_SEPEXC
            taSCOEXC5921_MASSIF_Line[tNUMSUP_5920] := S_GEEX5921_SCOEXC
            taTRTEXC5921_MASSIF_Line[tNUMSUP_5920] := S_GEEX5921_TRTEXC
            taTPSPRT5921_MASSIF_Line[tNUMSUP_5920] := S_GEEX5921_TPSPRT
            taCUMUOT5921_MASSIF_Line[tNUMSUP_5920] := S_GEEX5921_CUMUOT
            taCODPRP5921_MASSIF_Line[tNUMSUP_5920] := S_GEEX5921_CODPRP
            taCARDES5921_MASSIF_Line[tNUMSUP_5920] := S_GEEX5921_CARDES
            taDATSUP5921_MASSIF_Line[tNUMSUP_5920] := S_GEEX5921_DATSUP
            taHEUSUP5921_MASSIF_Line[tNUMSUP_5920] := S_GEEX5921_HEUSUP
            taNUMPAL5921_MASSIF_Line[tNUMSUP_5920] := S_GEEX5921_NUMPAL
            taSNUPAL5921_MASSIF_Line[tNUMSUP_5920] := S_GEEX5921_SNUPAL
            taCODPAL5921_MASSIF_Line[tNUMSUP_5920] := S_GEEX5921_CODPAL
            taETADES5921_MASSIF_Line[tNUMSUP_5920] := S_GEEX5921_ETADES
            taPTYDES5921_MASSIF_Line[tNUMSUP_5920] := S_GEEX5921_PTYDES
            taZONSTS5921_MASSIF_Line[tNUMSUP_5920] := S_GEEX5921_ZONSTS
            taALLSTS5921_MASSIF_Line[tNUMSUP_5920] := S_GEEX5921_ALLSTS
            taDPLSTS5921_MASSIF_Line[tNUMSUP_5920] := S_GEEX5921_DPLSTS
            taNIVSTS5921_MASSIF_Line[tNUMSUP_5920] := S_GEEX5921_NIVSTS
            taCODACT5921_MASSIF_Line[tNUMSUP_5920] := S_GEEX5921_CODACT
            taCODPRO5921_MASSIF_Line[tNUMSUP_5920] := S_GEEX5921_CODPRO
            taVALPRO5921_MASSIF_Line[tNUMSUP_5920] := S_GEEX5921_VALPRO
            taSPCPRO5921_MASSIF_Line[tNUMSUP_5920] := S_GEEX5921_SPCPRO
            taPCBPRO5921_MASSIF_Line[tNUMSUP_5920] := S_GEEX5921_PCBPRO
            taCIRPIC5921_MASSIF_Line[tNUMSUP_5920] := S_GEEX5921_CIRPIC
            taNUMPIC5921_MASSIF_Line[tNUMSUP_5920] := S_GEEX5921_NUMPIC
            taPRPPIC5921_MASSIF_Line[tNUMSUP_5920] := S_GEEX5921_PRPPIC
            taZONPIC5921_MASSIF_Line[tNUMSUP_5920] := S_GEEX5921_ZONPIC
            taALLPIC5921_MASSIF_Line[tNUMSUP_5920] := S_GEEX5921_ALLPIC
            taDPLPIC5921_MASSIF_Line[tNUMSUP_5920] := S_GEEX5921_DPLPIC
            taNIVPIC5921_MASSIF_Line[tNUMSUP_5920] := S_GEEX5921_NIVPIC
            taZONREA5921_MASSIF_Line[tNUMSUP_5920] := S_GEEX5921_ZONREA
            taALLREA5921_MASSIF_Line[tNUMSUP_5920] := S_GEEX5921_ALLREA
            taDPLREA5921_MASSIF_Line[tNUMSUP_5920] := S_GEEX5921_DPLREA
            taNIVREA5921_MASSIF_Line[tNUMSUP_5920] := S_GEEX5921_NIVREA
            taTRTCLS5921_MASSIF_Line[tNUMSUP_5920] := S_GEEX5921_TRTCLS
            taTOPCLS5921_MASSIF_Line[tNUMSUP_5920] := S_GEEX5921_TOPCLS
            taERRCLS5921_MASSIF_Line[tNUMSUP_5920] := S_GEEX5921_ERRCLS
            taTRTUOP5921_MASSIF_Line[tNUMSUP_5920] := S_GEEX5921_TRTUOP
            taTOPUOP5921_MASSIF_Line[tNUMSUP_5920] := S_GEEX5921_TOPUOP
            taERRUOP5921_MASSIF_Line[tNUMSUP_5920] := S_GEEX5921_ERRUOP
            taTRTPRP5921_MASSIF_Line[tNUMSUP_5920] := S_GEEX5921_TRTPRP
            taTOPPRP5921_MASSIF_Line[tNUMSUP_5920] := S_GEEX5921_TOPPRP
            taERRPRP5921_MASSIF_Line[tNUMSUP_5920] := S_GEEX5921_ERRPRP
            taTRTTOU5921_MASSIF_Line[tNUMSUP_5920] := S_GEEX5921_TRTTOU
            taTOPTOU5921_MASSIF_Line[tNUMSUP_5920] := S_GEEX5921_TOPTOU
            taERRTOU5921_MASSIF_Line[tNUMSUP_5920] := S_GEEX5921_ERRTOU
            taCNFSUP5921_MASSIF_Line[tNUMSUP_5920] := S_GEEX5921_CNFSUP
            taTOPHIS5921_MASSIF_Line[tNUMSUP_5920] := S_GEEX5921_TOPHIS
            taCUMLOG5921_MASSIF_Line[tNUMSUP_5920] := S_GEEX5921_CUMLOG
            taDATLIM5921_MASSIF_Line[tNUMSUP_5920] := S_GEEX5921_DATLIM
            taHEULIM5921_MASSIF_Line[tNUMSUP_5920] := S_GEEX5921_HEULIM
            taTOPMNQ5921_MASSIF_Line[tNUMSUP_5920] := S_GEEX5921_TOPMNQ
            taPTYORI5921_MASSIF_Line[tNUMSUP_5920] := S_GEEX5921_PTYORI
            taNUMTOI5921_MASSIF_Line[tNUMSUP_5920] := S_GEEX5921_NUMTOI
            taNUMCNT5921_MASSIF_Line[tNUMSUP_5920] := S_GEEX5921_NUMCNT
            taCODSTL5921_MASSIF_Line[tNUMSUP_5920] := S_GEEX5921_CODSTL
            taDISEXC5921_MASSIF_Line[tNUMSUP_5920] := S_GEEX5921_DISEXC
        ! FIM CAMPOS WMS
    ! MASSIFICACAO FINAL

	!BYPASS INICIO
        log("------------------------------------------------------------", NL)
        log("CODPAL: ",S_GEEX5921_CODPAL, NL)
        log("TOPHIS: ",S_GEEX5921_TOPHIS, NL)
        log("TRTEXC: ",S_GEEX5921_TRTEXC, NL)
        log("------------------------------------------------------------", NL)

        if length(peel(S_GEEX5921_CODPAL, " ")) = 0 or S_GEEX5921_TOPHIS = "1" or S_GEEX5921_TRTEXC = "9" then
            close(tFileOutBP)
            close(tFileOutTempBP)
            remove(tFileOutBP)
            remove(tFileOutTempBP)
            close(tDbBase)
            exit(1)
        endif

        R_GEEX5921_BP_CODEXC(S_GEEX5921_CODEXC)
        R_GEEX5921_BP_SEPEXC(S_GEEX5921_SEPEXC)
        R_GEEX5921_BP_SCOEXC(S_GEEX5921_SCOEXC)
        R_GEEX5921_BP_TRTEXC(S_GEEX5921_TRTEXC)
        R_GEEX5921_BP_TPSPRT(S_GEEX5921_TPSPRT)
        R_GEEX5921_BP_CUMUOT(S_GEEX5921_CUMUOT)
        R_GEEX5921_BP_CODPRP(S_GEEX5921_CODPRP)
        R_GEEX5921_BP_CARDES(S_GEEX5921_CARDES)
        R_GEEX5921_BP_DATSUP(S_GEEX5921_DATSUP)
        R_GEEX5921_BP_HEUSUP(S_GEEX5921_HEUSUP)
        R_GEEX5921_BP_NUMPAL(S_GEEX5921_NUMPAL)
        R_GEEX5921_BP_SNUPAL(S_GEEX5921_SNUPAL)
        R_GEEX5921_BP_CODPAL(S_GEEX5921_CODPAL)
        R_GEEX5921_BP_ETADES(S_GEEX5921_ETADES)
        R_GEEX5921_BP_PTYDES(S_GEEX5921_PTYDES)
        R_GEEX5921_BP_ZONSTS(S_GEEX5921_ZONSTS)
        R_GEEX5921_BP_ALLSTS(S_GEEX5921_ALLSTS)
        R_GEEX5921_BP_DPLSTS(S_GEEX5921_DPLSTS)
        R_GEEX5921_BP_NIVSTS(S_GEEX5921_NIVSTS)
        R_GEEX5921_BP_CODACT(S_GEEX5921_CODACT)
        R_GEEX5921_BP_CODPRO(S_GEEX5921_CODPRO)
        R_GEEX5921_BP_VALPRO(S_GEEX5921_VALPRO)
        R_GEEX5921_BP_SPCPRO(S_GEEX5921_SPCPRO)
        R_GEEX5921_BP_PCBPRO(S_GEEX5921_PCBPRO)
        R_GEEX5921_BP_CIRPIC(S_GEEX5921_CIRPIC)
        R_GEEX5921_BP_NUMPIC(S_GEEX5921_NUMPIC)
        R_GEEX5921_BP_PRPPIC(S_GEEX5921_PRPPIC)
        R_GEEX5921_BP_ZONPIC(S_GEEX5921_ZONPIC)
        R_GEEX5921_BP_ALLPIC(S_GEEX5921_ALLPIC)
        R_GEEX5921_BP_DPLPIC(S_GEEX5921_DPLPIC)
        R_GEEX5921_BP_NIVPIC(S_GEEX5921_NIVPIC)
        R_GEEX5921_BP_ZONREA(S_GEEX5921_ZONREA)
        R_GEEX5921_BP_ALLREA(S_GEEX5921_ALLREA)
        R_GEEX5921_BP_DPLREA(S_GEEX5921_DPLREA)
        R_GEEX5921_BP_NIVREA(S_GEEX5921_NIVREA)
        R_GEEX5921_BP_TRTCLS(S_GEEX5921_TRTCLS)
        R_GEEX5921_BP_TOPCLS(S_GEEX5921_TOPCLS)
        R_GEEX5921_BP_ERRCLS(S_GEEX5921_ERRCLS)
        R_GEEX5921_BP_TRTUOP(S_GEEX5921_TRTUOP)
        R_GEEX5921_BP_TOPUOP(S_GEEX5921_TOPUOP)
        R_GEEX5921_BP_ERRUOP(S_GEEX5921_ERRUOP)
        R_GEEX5921_BP_TRTPRP(S_GEEX5921_TRTPRP)
        R_GEEX5921_BP_TOPPRP(S_GEEX5921_TOPPRP)
        R_GEEX5921_BP_ERRPRP(S_GEEX5921_ERRPRP)
        R_GEEX5921_BP_TRTTOU(S_GEEX5921_TRTTOU)
        R_GEEX5921_BP_TOPTOU(S_GEEX5921_TOPTOU)
        R_GEEX5921_BP_ERRTOU(S_GEEX5921_ERRTOU)
        R_GEEX5921_BP_CNFSUP(S_GEEX5921_CNFSUP)
        R_GEEX5921_BP_TOPHIS(S_GEEX5921_TOPHIS)
        R_GEEX5921_BP_CUMLOG(S_GEEX5921_CUMLOG)
        R_GEEX5921_BP_DATLIM(S_GEEX5921_DATLIM)
        R_GEEX5921_BP_HEULIM(S_GEEX5921_HEULIM)
        R_GEEX5921_BP_TOPMNQ(S_GEEX5921_TOPMNQ)
        R_GEEX5921_BP_PTYORI(S_GEEX5921_PTYORI)
        R_GEEX5921_BP_NUMTOI(S_GEEX5921_NUMTOI)
        R_GEEX5921_BP_NUMCNT(S_GEEX5921_NUMCNT)
        R_GEEX5921_BP_CODSTL(S_GEEX5921_CODSTL)
        R_GEEX5921_BP_DISEXC(S_GEEX5921_DISEXC)
		
		flush(0,0,NL) >> tFileOutTempBP
	!BYPASS FINAL
endline

!==============================================================================

line(1:"59.22")
    ! MASSIFICACAO INICIO
        ! CAMPOS WMS
            taCODEXC5922_MASSIF_Line[tNUMSUP_5920] := S_GEEX5922_CODEXC
            taSEPEXC5922_MASSIF_Line[tNUMSUP_5920] := S_GEEX5922_SEPEXC
            taSCOEXC5922_MASSIF_Line[tNUMSUP_5920] := S_GEEX5922_SCOEXC
            taTRTEXC5922_MASSIF_Line[tNUMSUP_5920] := S_GEEX5922_TRTEXC
            taCODLDP5922_MASSIF_Line[tNUMSUP_5920] := S_GEEX5922_CODLDP
            taCODCMP5922_MASSIF_Line[tNUMSUP_5920] := S_GEEX5922_CODCMP
            taNUMCMP5922_MASSIF_Line[tNUMSUP_5920] := S_GEEX5922_NUMCMP
            taSNUCMP5922_MASSIF_Line[tNUMSUP_5920] := S_GEEX5922_SNUCMP
            taNIVITR5922_MASSIF_Line[tNUMSUP_5920] := S_GEEX5922_NIVITR
            taTOPETI5922_MASSIF_Line[tNUMSUP_5920] := S_GEEX5922_TOPETI
            taCATREF5922_MASSIF_Line[tNUMSUP_5920] := S_GEEX5922_CATREF
            taINDCHT5922_MASSIF_Line[tNUMSUP_5920] := S_GEEX5922_INDCHT
            taNBRDAT5922_MASSIF_Line[tNUMSUP_5920] := S_GEEX5922_NBRDAT
            taORDEMB5922_MASSIF_Line[tNUMSUP_5920] := S_GEEX5922_ORDEMB
            taTOPPAQ5922_MASSIF_Line[tNUMSUP_5920] := S_GEEX5922_TOPPAQ
            taNUMPLB5922_MASSIF_Line[tNUMSUP_5920] := S_GEEX5922_NUMPLB
            taPDBEMB5922_MASSIF_Line[tNUMSUP_5920] := S_GEEX5922_PDBEMB
            taSSCCMP5922_MASSIF_Line[tNUMSUP_5920] := S_GEEX5922_SSCCMP
            taDATPAK5922_MASSIF_Line[tNUMSUP_5920] := S_GEEX5922_DATPAK
            taHEUPAK5922_MASSIF_Line[tNUMSUP_5920] := S_GEEX5922_HEUPAK
            taPOITOT5922_MASSIF_Line[tNUMSUP_5920] := S_GEEX5922_POITOT
            taNUMTKG5922_MASSIF_Line[tNUMSUP_5920] := S_GEEX5922_NUMTKG
            taNUMTKR5922_MASSIF_Line[tNUMSUP_5920] := S_GEEX5922_NUMTKR
            taDISEXC5922_MASSIF_Line[tNUMSUP_5920] := S_GEEX5922_DISEXC
        ! FIM CAMPOS WMS
    ! MASSIFICACAO FINAL
endline

!==============================================================================

line(1:"59.29")
    ! MASSIFICACAO INICIO
        ! CAMPOS WMS
            taCODEXC5929_MASSIF_Line[tNUMSUP_5920] := S_GEEX5929_CODEXC
            taSEPEXC5929_MASSIF_Line[tNUMSUP_5920] := S_GEEX5929_SEPEXC
            taSCOEXC5929_MASSIF_Line[tNUMSUP_5920] := S_GEEX5929_SCOEXC
            taTRTEXC5929_MASSIF_Line[tNUMSUP_5920] := S_GEEX5929_TRTEXC
            taLIBVAG5929_MASSIF_Line[tNUMSUP_5920] := S_GEEX5929_LIBVAG
            taLIBCIR5929_MASSIF_Line[tNUMSUP_5920] := S_GEEX5929_LIBCIR
            taTYPLIV5929_MASSIF_Line[tNUMSUP_5920] := S_GEEX5929_TYPLIV
            taVOLUOP5929_MASSIF_Line[tNUMSUP_5920] := S_GEEX5929_VOLUOP
            taEDISIT5929_MASSIF_Line[tNUMSUP_5920] := S_GEEX5929_EDISIT
            taEDICLI5929_MASSIF_Line[tNUMSUP_5920] := S_GEEX5929_EDICLI
            taTYPACT5929_MASSIF_Line[tNUMSUP_5920] := S_GEEX5929_TYPACT
            taREFMIT5929_MASSIF_Line[tNUMSUP_5920] := S_GEEX5929_REFMIT
            taNUMREC5929_MASSIF_Line[tNUMSUP_5920] := S_GEEX5929_NUMREC
            taSNUREC5929_MASSIF_Line[tNUMSUP_5920] := S_GEEX5929_SNUREC
            taTYPCIR5929_MASSIF_Line[tNUMSUP_5920] := S_GEEX5929_TYPCIR
            taCODTLI5929_MASSIF_Line[tNUMSUP_5920] := S_GEEX5929_CODTLI
            taDISEXC5929_MASSIF_Line[tNUMSUP_5920] := S_GEEX5929_DISEXC
        ! FIM CAMPOS WMS
    ! MASSIFICACAO FINAL
endline

!==============================================================================

line(1:"59.40")
    ! MASSIFICACAO INICIO
        ! CAMPOS WWMS
            taCODEXC5940_MASSIF_Line[tNUMSUP_5920] := S_GEEX5940_CODEXC
            taSEPEXC5940_MASSIF_Line[tNUMSUP_5920] := S_GEEX5940_SEPEXC
            taSCOEXC5940_MASSIF_Line[tNUMSUP_5920] := S_GEEX5940_SCOEXC
            taTRTEXC5940_MASSIF_Line[tNUMSUP_5920] := S_GEEX5940_TRTEXC
            taNUMSUP5940_MASSIF_Line[tNUMSUP_5920] := S_GEEX5940_NUMSUP
            taSNUSUP5940_MASSIF_Line[tNUMSUP_5920] := S_GEEX5940_SNUSUP
            taSEQSUP5940_MASSIF_Line[tNUMSUP_5920] := S_GEEX5940_SEQSUP
            taNUMLIV5940_MASSIF_Line[tNUMSUP_5920] := S_GEEX5940_NUMLIV
            taSNULIV5940_MASSIF_Line[tNUMSUP_5920] := S_GEEX5940_SNULIV
            taSEQLIV5940_MASSIF_Line[tNUMSUP_5920] := S_GEEX5940_SEQLIV
            taTOPLIV5940_MASSIF_Line[tNUMSUP_5920] := S_GEEX5940_TOPLIV
            taCODCLI5940_MASSIF_Line[tNUMSUP_5920] := S_GEEX5940_CODCLI
            taCLILIV5940_MASSIF_Line[tNUMSUP_5920] := S_GEEX5940_CLILIV
            taCODACT5940_MASSIF_Line[tNUMSUP_5920] := S_GEEX5940_CODACT
            taCODPRO5940_MASSIF_Line[tNUMSUP_5920] := S_GEEX5940_CODPRO
            taVALPRO5940_MASSIF_Line[tNUMSUP_5920] := S_GEEX5940_VALPRO
            taVAPPRO5940_MASSIF_Line[tNUMSUP_5920] := S_GEEX5940_VAPPRO
            taDS1PRO5940_MASSIF_Line[tNUMSUP_5920] := S_GEEX5940_DS1PRO
            taDS2PRO5940_MASSIF_Line[tNUMSUP_5920] := S_GEEX5940_DS2PRO
            taFAMPRO5940_MASSIF_Line[tNUMSUP_5920] := S_GEEX5940_FAMPRO
            taANAPRO5940_MASSIF_Line[tNUMSUP_5920] := S_GEEX5940_ANAPRO
            taUNIPRO5940_MASSIF_Line[tNUMSUP_5920] := S_GEEX5940_UNIPRO
            taMESPRO5940_MASSIF_Line[tNUMSUP_5920] := S_GEEX5940_MESPRO
            taPDBCOL5940_MASSIF_Line[tNUMSUP_5920] := S_GEEX5940_PDBCOL
            taVOLCOL5940_MASSIF_Line[tNUMSUP_5920] := S_GEEX5940_VOLCOL
            taCOECOL5940_MASSIF_Line[tNUMSUP_5920] := S_GEEX5940_COECOL
            taCODALC5940_MASSIF_Line[tNUMSUP_5920] := S_GEEX5940_CODALC
            taDEGALC5940_MASSIF_Line[tNUMSUP_5920] := S_GEEX5940_DEGALC
            taVOLALC5940_MASSIF_Line[tNUMSUP_5920] := S_GEEX5940_VOLALC
            taCODEAP5940_MASSIF_Line[tNUMSUP_5920] := S_GEEX5940_CODEAP
            taCODPRN5940_MASSIF_Line[tNUMSUP_5920] := S_GEEX5940_CODPRN
            taEDIPRO5940_MASSIF_Line[tNUMSUP_5920] := S_GEEX5940_EDIPRO
            taUNICDE5940_MASSIF_Line[tNUMSUP_5920] := S_GEEX5940_UNICDE
            taCVTUVC5940_MASSIF_Line[tNUMSUP_5920] := S_GEEX5940_CVTUVC
        ! FIM CAMPOS WMS
    ! MASSIFICACAO FINAL

	!BYPASS INICIO
        R_GEEX5940_BP_CODEXC(S_GEEX5940_CODEXC)
        R_GEEX5940_BP_SEPEXC(S_GEEX5940_SEPEXC)
        R_GEEX5940_BP_SCOEXC(S_GEEX5940_SCOEXC)
        R_GEEX5940_BP_TRTEXC(S_GEEX5940_TRTEXC)
        R_GEEX5940_BP_NUMSUP(S_GEEX5940_NUMSUP)
        R_GEEX5940_BP_SNUSUP(S_GEEX5940_SNUSUP)
        R_GEEX5940_BP_SEQSUP(S_GEEX5940_SEQSUP)
        R_GEEX5940_BP_NUMLIV(S_GEEX5940_NUMLIV)
        R_GEEX5940_BP_SNULIV(S_GEEX5940_SNULIV)
        R_GEEX5940_BP_SEQLIV(S_GEEX5940_SEQLIV)
        R_GEEX5940_BP_TOPLIV(S_GEEX5940_TOPLIV)
        R_GEEX5940_BP_CODCLI(S_GEEX5940_CODCLI)
        R_GEEX5940_BP_CLILIV(S_GEEX5940_CLILIV)
        R_GEEX5940_BP_CODACT(S_GEEX5940_CODACT)
        R_GEEX5940_BP_CODPRO(S_GEEX5940_CODPRO)
        R_GEEX5940_BP_VALPRO(S_GEEX5940_VALPRO)
        R_GEEX5940_BP_VAPPRO(S_GEEX5940_VAPPRO)
        R_GEEX5940_BP_DS1PRO(S_GEEX5940_DS1PRO)
        R_GEEX5940_BP_DS2PRO(S_GEEX5940_DS2PRO)
        R_GEEX5940_BP_FAMPRO(S_GEEX5940_FAMPRO)
        R_GEEX5940_BP_ANAPRO(S_GEEX5940_ANAPRO)
        R_GEEX5940_BP_UNIPRO(S_GEEX5940_UNIPRO)
        R_GEEX5940_BP_MESPRO(S_GEEX5940_MESPRO)
        R_GEEX5940_BP_PDBCOL(S_GEEX5940_PDBCOL)
        R_GEEX5940_BP_VOLCOL(S_GEEX5940_VOLCOL)
        R_GEEX5940_BP_COECOL(S_GEEX5940_COECOL)
        R_GEEX5940_BP_CODALC(S_GEEX5940_CODALC)
        R_GEEX5940_BP_DEGALC(S_GEEX5940_DEGALC)
        R_GEEX5940_BP_VOLALC(S_GEEX5940_VOLALC)
        R_GEEX5940_BP_CODEAP(S_GEEX5940_CODEAP)
        R_GEEX5940_BP_CODPRN(S_GEEX5940_CODPRN)
        R_GEEX5940_BP_EDIPRO(S_GEEX5940_EDIPRO)
        R_GEEX5940_BP_UNICDE(S_GEEX5940_UNICDE)
        R_GEEX5940_BP_CVTUVC(S_GEEX5940_CVTUVC)
		
		flush(0,0,NL) >> tFileOutTempBP
	!BYPASS FINAL
endline

!==============================================================================

line(1:"59.41")
    ! MASSIFICACAO INICIO
        ! CAMPOS WWMS
            taCODEXC5941_MASSIF_Line[tNUMSUP_5920] := S_GEEX5941_CODEXC
            taSEPEXC5941_MASSIF_Line[tNUMSUP_5920] := S_GEEX5941_SEPEXC
            taSCOEXC5941_MASSIF_Line[tNUMSUP_5920] := S_GEEX5941_SCOEXC
            taTRTEXC5941_MASSIF_Line[tNUMSUP_5920] := S_GEEX5941_TRTEXC
            taTYPSTK5941_MASSIF_Line[tNUMSUP_5920] := S_GEEX5941_TYPSTK
            taAIGPRI5941_MASSIF_Line[tNUMSUP_5920] := S_GEEX5941_AIGPRI
            taPRILIV5941_MASSIF_Line[tNUMSUP_5920] := S_GEEX5941_PRILIV
            taTYPOPE5941_MASSIF_Line[tNUMSUP_5920] := S_GEEX5941_TYPOPE
            taNUMOPE5941_MASSIF_Line[tNUMSUP_5920] := S_GEEX5941_NUMOPE
            taMSGLIG5941_MASSIF_Line[tNUMSUP_5920] := S_GEEX5941_MSGLIG
            taDIPLIV5941_MASSIF_Line[tNUMSUP_5920] := S_GEEX5941_DIPLIV
            taNLILIV5941_MASSIF_Line[tNUMSUP_5920] := S_GEEX5941_NLILIV
            taPRPPIC5941_MASSIF_Line[tNUMSUP_5920] := S_GEEX5941_PRPPIC
            taZONPIC5941_MASSIF_Line[tNUMSUP_5920] := S_GEEX5941_ZONPIC
            taALLPIC5941_MASSIF_Line[tNUMSUP_5920] := S_GEEX5941_ALLPIC
            taDPLPIC5941_MASSIF_Line[tNUMSUP_5920] := S_GEEX5941_DPLPIC
            taNIVPIC5941_MASSIF_Line[tNUMSUP_5920] := S_GEEX5941_NIVPIC
            taNUMPIC5941_MASSIF_Line[tNUMSUP_5920] := S_GEEX5941_NUMPIC
            taUVCCDE5941_MASSIF_Line[tNUMSUP_5920] := S_GEEX5941_UVCCDE
            taUVCSRV5941_MASSIF_Line[tNUMSUP_5920] := S_GEEX5941_UVCSRV
            taUVCLIV5941_MASSIF_Line[tNUMSUP_5920] := S_GEEX5941_UVCLIV
            taPDNLIV5941_MASSIF_Line[tNUMSUP_5920] := S_GEEX5941_PDNLIV
            taSPCPRO5941_MASSIF_Line[tNUMSUP_5920] := S_GEEX5941_SPCPRO
            taPCBPRO5941_MASSIF_Line[tNUMSUP_5920] := S_GEEX5941_PCBPRO
            taCOLCOU5941_MASSIF_Line[tNUMSUP_5920] := S_GEEX5941_COLCOU
            taCOUPAL5941_MASSIF_Line[tNUMSUP_5920] := S_GEEX5941_COUPAL
            taGERPAL5941_MASSIF_Line[tNUMSUP_5920] := S_GEEX5941_GERPAL
            taGERHAU5941_MASSIF_Line[tNUMSUP_5920] := S_GEEX5941_GERHAU
            taNUMPAL5941_MASSIF_Line[tNUMSUP_5920] := S_GEEX5941_NUMPAL
            taSNUPAL5941_MASSIF_Line[tNUMSUP_5920] := S_GEEX5941_SNUPAL
            taCODPAL5941_MASSIF_Line[tNUMSUP_5920] := S_GEEX5941_CODPAL
            taNUMLOT5941_MASSIF_Line[tNUMSUP_5920] := S_GEEX5941_NUMLOT
            taCODLOT5941_MASSIF_Line[tNUMSUP_5920] := S_GEEX5941_CODLOT
            taDATFVI5941_MASSIF_Line[tNUMSUP_5920] := S_GEEX5941_DATFVI
            taDISEXC5941_MASSIF_Line[tNUMSUP_5920] := S_GEEX5941_DISEXC
        ! FIM CAMPOS WMS
    ! MASSIFICACAO FINAL

	!BYPASS INICIO
        R_GEEX5941_BP_CODEXC(S_GEEX5941_CODEXC)
        R_GEEX5941_BP_SEPEXC(S_GEEX5941_SEPEXC)
        R_GEEX5941_BP_SCOEXC(S_GEEX5941_SCOEXC)
        R_GEEX5941_BP_TRTEXC(S_GEEX5941_TRTEXC)
        R_GEEX5941_BP_TYPSTK(S_GEEX5941_TYPSTK)
        R_GEEX5941_BP_AIGPRI(S_GEEX5941_AIGPRI)
        R_GEEX5941_BP_PRILIV(S_GEEX5941_PRILIV)
        R_GEEX5941_BP_TYPOPE(S_GEEX5941_TYPOPE)
        R_GEEX5941_BP_NUMOPE(S_GEEX5941_NUMOPE)
        R_GEEX5941_BP_MSGLIG(S_GEEX5941_MSGLIG)
        R_GEEX5941_BP_DIPLIV(S_GEEX5941_DIPLIV)
        R_GEEX5941_BP_NLILIV(S_GEEX5941_NLILIV)
        R_GEEX5941_BP_PRPPIC(S_GEEX5941_PRPPIC)
        R_GEEX5941_BP_ZONPIC(S_GEEX5941_ZONPIC)
        R_GEEX5941_BP_ALLPIC(S_GEEX5941_ALLPIC)
        R_GEEX5941_BP_DPLPIC(S_GEEX5941_DPLPIC)
        R_GEEX5941_BP_NIVPIC(S_GEEX5941_NIVPIC)
        R_GEEX5941_BP_NUMPIC(S_GEEX5941_NUMPIC)
        R_GEEX5941_BP_UVCCDE(S_GEEX5941_UVCCDE)
        R_GEEX5941_BP_UVCSRV(S_GEEX5941_UVCSRV)
        R_GEEX5941_BP_UVCLIV(S_GEEX5941_UVCLIV)
        R_GEEX5941_BP_PDNLIV(S_GEEX5941_PDNLIV)
        R_GEEX5941_BP_SPCPRO(S_GEEX5941_SPCPRO)
        R_GEEX5941_BP_PCBPRO(S_GEEX5941_PCBPRO)
        R_GEEX5941_BP_COLCOU(S_GEEX5941_COLCOU)
        R_GEEX5941_BP_COUPAL(S_GEEX5941_COUPAL)
        R_GEEX5941_BP_GERPAL(S_GEEX5941_GERPAL)
        R_GEEX5941_BP_GERHAU(S_GEEX5941_GERHAU)
        R_GEEX5941_BP_NUMPAL(S_GEEX5941_NUMPAL)
        R_GEEX5941_BP_SNUPAL(S_GEEX5941_SNUPAL)
        R_GEEX5941_BP_CODPAL(S_GEEX5941_CODPAL)
        R_GEEX5941_BP_NUMLOT(S_GEEX5941_NUMLOT)
        R_GEEX5941_BP_CODLOT(S_GEEX5941_CODLOT)
        R_GEEX5941_BP_DATFVI(S_GEEX5941_DATFVI)
        R_GEEX5941_BP_DISEXC(S_GEEX5941_DISEXC)
		
		flush(0,0,NL) >> tFileOutTempBP
	!BYPASS FINAL
endline

!==============================================================================

line(1:"59.42")
    ! MASSIFICACAO INICIO
        ! CAMPOS WWMS
            taCODEXC5942_MASSIF_Line[tNUMSUP_5920] := S_GEEX5942_CODEXC
            taSEPEXC5942_MASSIF_Line[tNUMSUP_5920] := S_GEEX5942_SEPEXC
            taSCOEXC5942_MASSIF_Line[tNUMSUP_5920] := S_GEEX5942_SCOEXC
            taTRTEXC5942_MASSIF_Line[tNUMSUP_5920] := S_GEEX5942_TRTEXC
            taZONSTS5942_MASSIF_Line[tNUMSUP_5920] := S_GEEX5942_ZONSTS
            taALLSTS5942_MASSIF_Line[tNUMSUP_5920] := S_GEEX5942_ALLSTS
            taDPLSTS5942_MASSIF_Line[tNUMSUP_5920] := S_GEEX5942_DPLSTS
            taNIVSTS5942_MASSIF_Line[tNUMSUP_5920] := S_GEEX5942_NIVSTS
            taCODACL5942_MASSIF_Line[tNUMSUP_5920] := S_GEEX5942_CODACL
            taMOTMVT5942_MASSIF_Line[tNUMSUP_5920] := S_GEEX5942_MOTMVT
            taZONORI5942_MASSIF_Line[tNUMSUP_5920] := S_GEEX5942_ZONORI
            taALLORI5942_MASSIF_Line[tNUMSUP_5920] := S_GEEX5942_ALLORI
            taDPLORI5942_MASSIF_Line[tNUMSUP_5920] := S_GEEX5942_DPLORI
            taNIVORI5942_MASSIF_Line[tNUMSUP_5920] := S_GEEX5942_NIVORI
            taUVCMNQ5942_MASSIF_Line[tNUMSUP_5920] := S_GEEX5942_UVCMNQ
            taPDNUVC5942_MASSIF_Line[tNUMSUP_5920] := S_GEEX5942_PDNUVC
            taNUMCLS5942_MASSIF_Line[tNUMSUP_5920] := S_GEEX5942_NUMCLS
            taCODCLS5942_MASSIF_Line[tNUMSUP_5920] := S_GEEX5942_CODCLS
            taNUMRPT5942_MASSIF_Line[tNUMSUP_5920] := S_GEEX5942_NUMRPT
            taSNURPT5942_MASSIF_Line[tNUMSUP_5920] := S_GEEX5942_SNURPT
            taTOPRPT5942_MASSIF_Line[tNUMSUP_5920] := S_GEEX5942_TOPRPT
            taCOELOG5942_MASSIF_Line[tNUMSUP_5920] := S_GEEX5942_COELOG
            taCNFLIG5942_MASSIF_Line[tNUMSUP_5920] := S_GEEX5942_CNFLIG
            taUVCDIF5942_MASSIF_Line[tNUMSUP_5920] := S_GEEX5942_UVCDIF
            taPDBUVC5942_MASSIF_Line[tNUMSUP_5920] := S_GEEX5942_PDBUVC
            taREFLIV5942_MASSIF_Line[tNUMSUP_5920] := S_GEEX5942_REFLIV
            taUVCEMB5942_MASSIF_Line[tNUMSUP_5920] := S_GEEX5942_UVCEMB
            taMAJPOI5942_MASSIF_Line[tNUMSUP_5920] := S_GEEX5942_MAJPOI
            taSTKOUV5942_MASSIF_Line[tNUMSUP_5920] := S_GEEX5942_STKOUV
            taCODSUP5942_MASSIF_Line[tNUMSUP_5920] := S_GEEX5942_CODSUP
            taDATFAB5942_MASSIF_Line[tNUMSUP_5920] := S_GEEX5942_DATFAB
            taVLDDAT5942_MASSIF_Line[tNUMSUP_5920] := S_GEEX5942_VLDDAT
            taTOPCOL5942_MASSIF_Line[tNUMSUP_5920] := S_GEEX5942_TOPCOL
            taVTLSEQ5942_MASSIF_Line[tNUMSUP_5920] := S_GEEX5942_VTLSEQ
            taREFORI5942_MASSIF_Line[tNUMSUP_5920] := S_GEEX5942_REFORI
            taCODOPE5942_MASSIF_Line[tNUMSUP_5920] := S_GEEX5942_CODOPE
            taNUMORI5942_MASSIF_Line[tNUMSUP_5920] := S_GEEX5942_NUMORI
            taSNUORI5942_MASSIF_Line[tNUMSUP_5920] := S_GEEX5942_SNUORI
            taDISEXC5942_MASSIF_Line[tNUMSUP_5920] := S_GEEX5942_DISEXC
        ! FIM CAMPOS WMS
    ! MASSIFICACAO FINAL

	!BYPASS INICIO
        R_GEEX5942_BP_CODEXC(S_GEEX5942_CODEXC)
        R_GEEX5942_BP_SEPEXC(S_GEEX5942_SEPEXC)
        R_GEEX5942_BP_SCOEXC(S_GEEX5942_SCOEXC)
        R_GEEX5942_BP_TRTEXC(S_GEEX5942_TRTEXC)
        R_GEEX5942_BP_ZONSTS(S_GEEX5942_ZONSTS)
        R_GEEX5942_BP_ALLSTS(S_GEEX5942_ALLSTS)
        R_GEEX5942_BP_DPLSTS(S_GEEX5942_DPLSTS)
        R_GEEX5942_BP_NIVSTS(S_GEEX5942_NIVSTS)
        R_GEEX5942_BP_CODACL(S_GEEX5942_CODACL)
        R_GEEX5942_BP_MOTMVT(S_GEEX5942_MOTMVT)
        R_GEEX5942_BP_ZONORI(S_GEEX5942_ZONORI)
        R_GEEX5942_BP_ALLORI(S_GEEX5942_ALLORI)
        R_GEEX5942_BP_DPLORI(S_GEEX5942_DPLORI)
        R_GEEX5942_BP_NIVORI(S_GEEX5942_NIVORI)
        R_GEEX5942_BP_UVCMNQ(S_GEEX5942_UVCMNQ)
        R_GEEX5942_BP_PDNUVC(S_GEEX5942_PDNUVC)
        R_GEEX5942_BP_NUMCLS(S_GEEX5942_NUMCLS)
        R_GEEX5942_BP_CODCLS(S_GEEX5942_CODCLS)
        R_GEEX5942_BP_NUMRPT(S_GEEX5942_NUMRPT)
        R_GEEX5942_BP_SNURPT(S_GEEX5942_SNURPT)
        R_GEEX5942_BP_TOPRPT(S_GEEX5942_TOPRPT)
        R_GEEX5942_BP_COELOG(S_GEEX5942_COELOG)
        R_GEEX5942_BP_CNFLIG(S_GEEX5942_CNFLIG)
        R_GEEX5942_BP_UVCDIF(S_GEEX5942_UVCDIF)
        R_GEEX5942_BP_PDBUVC(S_GEEX5942_PDBUVC)
        R_GEEX5942_BP_REFLIV(S_GEEX5942_REFLIV)
        R_GEEX5942_BP_UVCEMB(S_GEEX5942_UVCEMB)
        R_GEEX5942_BP_MAJPOI(S_GEEX5942_MAJPOI)
        R_GEEX5942_BP_STKOUV(S_GEEX5942_STKOUV)
        R_GEEX5942_BP_CODSUP(S_GEEX5942_CODSUP)
        R_GEEX5942_BP_DATFAB(S_GEEX5942_DATFAB)
        R_GEEX5942_BP_VLDDAT(S_GEEX5942_VLDDAT)
        R_GEEX5942_BP_TOPCOL(S_GEEX5942_TOPCOL)
        R_GEEX5942_BP_VTLSEQ(S_GEEX5942_VTLSEQ)
        R_GEEX5942_BP_REFORI(S_GEEX5942_REFORI)
        R_GEEX5942_BP_CODOPE(S_GEEX5942_CODOPE)
        R_GEEX5942_BP_NUMORI(S_GEEX5942_NUMORI)
        R_GEEX5942_BP_SNUORI(S_GEEX5942_SNUORI)
        R_GEEX5942_BP_DISEXC(S_GEEX5942_DISEXC)
		
		flush(0,0,NL) >> tFileOutTempBP
	!BYPASS FINAL
endline

!==============================================================================

line(1:"59.45")
    ! MASSIFICACAO INICIO
        ! CAMPOS WWMS
            taCODEXC5945_MASSIF_Line[tNUMSUP_5920] := S_GEEX5945_CODEXC
            taSEPEXC5945_MASSIF_Line[tNUMSUP_5920] := S_GEEX5945_SEPEXC
            taSCOEXC5945_MASSIF_Line[tNUMSUP_5920] := S_GEEX5945_SCOEXC
            taTRTEXC5945_MASSIF_Line[tNUMSUP_5920] := S_GEEX5945_TRTEXC
            taNUMLIV5945_MASSIF_Line[tNUMSUP_5920] := S_GEEX5945_NUMLIV
            taSNULIV5945_MASSIF_Line[tNUMSUP_5920] := S_GEEX5945_SNULIV
            taREFLIV5945_MASSIF_Line[tNUMSUP_5920] := S_GEEX5945_REFLIV
            taNLILIV5945_MASSIF_Line[tNUMSUP_5920] := S_GEEX5945_NLILIV
            taCODACT5945_MASSIF_Line[tNUMSUP_5920] := S_GEEX5945_CODACT
            taCODCLI5945_MASSIF_Line[tNUMSUP_5920] := S_GEEX5945_CODCLI
            taCODPRO5945_MASSIF_Line[tNUMSUP_5920] := S_GEEX5945_CODPRO
            taVALPRO5945_MASSIF_Line[tNUMSUP_5920] := S_GEEX5945_VALPRO
            taDS1PRO5945_MASSIF_Line[tNUMSUP_5920] := S_GEEX5945_DS1PRO
            taDS2PRO5945_MASSIF_Line[tNUMSUP_5920] := S_GEEX5945_DS2PRO
            taDS3PRO5945_MASSIF_Line[tNUMSUP_5920] := S_GEEX5945_DS3PRO
            taFAMPRO5945_MASSIF_Line[tNUMSUP_5920] := S_GEEX5945_FAMPRO
            taDISEXC5945_MASSIF_Line[tNUMSUP_5920] := S_GEEX5945_DISEXC
        ! FIM CAMPOS WMS
    ! MASSIFICACAO FINAL

    !BYPASS INICIO
        R_GEEX5945_BP_CODEXC(S_GEEX5945_CODEXC)
        R_GEEX5945_BP_SEPEXC(S_GEEX5945_SEPEXC)
        R_GEEX5945_BP_SCOEXC(S_GEEX5945_SCOEXC)
        R_GEEX5945_BP_TRTEXC(S_GEEX5945_TRTEXC)
        R_GEEX5945_BP_NUMLIV(S_GEEX5945_NUMLIV)
        R_GEEX5945_BP_SNULIV(S_GEEX5945_SNULIV)
        R_GEEX5945_BP_REFLIV(S_GEEX5945_REFLIV)
        R_GEEX5945_BP_NLILIV(S_GEEX5945_NLILIV)
        R_GEEX5945_BP_CODACT(S_GEEX5945_CODACT)
        R_GEEX5945_BP_CODCLI(S_GEEX5945_CODCLI)
        R_GEEX5945_BP_CODPRO(S_GEEX5945_CODPRO)
        R_GEEX5945_BP_VALPRO(S_GEEX5945_VALPRO)
        R_GEEX5945_BP_DS1PRO(S_GEEX5945_DS1PRO)
        R_GEEX5945_BP_DS2PRO(S_GEEX5945_DS2PRO)
        R_GEEX5945_BP_DS3PRO(S_GEEX5945_DS3PRO)
        R_GEEX5945_BP_FAMPRO(S_GEEX5945_FAMPRO)
        R_GEEX5945_BP_DISEXC(S_GEEX5945_DISEXC)

		flush(0,0,NL) >> tFileOutTempBP
    !BYPASS FINAL
endline

!==============================================================================

line(1:"59.90")
    ! MASSIFICACAO INICIO
        ! CAMPOS WWMS
            taCODEXC5990_MASSIF_Line[tNUMSUP_5920] := S_GEEX5990_CODEXC
            taSEPEXC5990_MASSIF_Line[tNUMSUP_5920] := S_GEEX5990_SEPEXC
            taSCOEXC5990_MASSIF_Line[tNUMSUP_5920] := S_GEEX5990_SCOEXC
            taTRTEXC5990_MASSIF_Line[tNUMSUP_5920] := S_GEEX5990_TRTEXC
            taNUMPAL5990_MASSIF_Line[tNUMSUP_5920] := S_GEEX5990_NUMPAL
            taSNUPAL5990_MASSIF_Line[tNUMSUP_5920] := S_GEEX5990_SNUPAL
            taCODACT5990_MASSIF_Line[tNUMSUP_5920] := S_GEEX5990_CODACT
            taCODCLI5990_MASSIF_Line[tNUMSUP_5920] := S_GEEX5990_CODCLI
            taCODPRO5990_MASSIF_Line[tNUMSUP_5920] := S_GEEX5990_CODPRO
            taVALPRO5990_MASSIF_Line[tNUMSUP_5920] := S_GEEX5990_VALPRO
            taCODPAL5990_MASSIF_Line[tNUMSUP_5920] := S_GEEX5990_CODPAL
            taMOTIMM5990_MASSIF_Line[tNUMSUP_5920] := S_GEEX5990_MOTIMM
            taDATLIB5990_MASSIF_Line[tNUMSUP_5920] := S_GEEX5990_DATLIB
            taHEULIB5990_MASSIF_Line[tNUMSUP_5920] := S_GEEX5990_HEULIB
            taINDLIB5990_MASSIF_Line[tNUMSUP_5920] := S_GEEX5990_INDLIB
            taIMMBKL5990_MASSIF_Line[tNUMSUP_5920] := S_GEEX5990_IMMBKL
            taPALIMM5990_MASSIF_Line[tNUMSUP_5920] := S_GEEX5990_PALIMM
            taDATBKL5990_MASSIF_Line[tNUMSUP_5920] := S_GEEX5990_DATBKL
            taHEUBKL5990_MASSIF_Line[tNUMSUP_5920] := S_GEEX5990_HEUBKL
            taDATIMM5990_MASSIF_Line[tNUMSUP_5920] := S_GEEX5990_DATIMM
            taHEUIMM5990_MASSIF_Line[tNUMSUP_5920] := S_GEEX5990_HEUIMM
            taDISEXC5990_MASSIF_Line[tNUMSUP_5920] := S_GEEX5990_DISEXC
        ! FIM CAMPOS WMS
    ! MASSIFICACAO FINAL

	!BYPASS INICIO
        
        log("------------------------------------------------------------", NL)
        log("IMMBKL: ",peel(S_GEEX5990_IMMBKL," "), " de ", length(peel(S_GEEX5990_IMMBKL," ")), NL)
        log("MOTIMM: ",S_GEEX5990_MOTIMM, NL)
        log("------------------------------------------------------------", NL)

        if length(peel(S_GEEX5990_IMMBKL," ")) > 0 then
            tMOTIMM := S_GEEX5990_IMMBKL
        else
            tMOTIMM := S_GEEX5990_MOTIMM
        endif

        tQuery := build("SELECT DISTINCT TRIM(RUB.LIBVAL) LIBVAL",NL," "\
                        "FROM FGE50FM",tToInfologPrefixFilename,".GEZZRU IMO",NL," "\
                        "JOIN FGE50FM",tToInfologPrefixFilename,".GEZZRI RUB",NL," "\
                        "ON IMO.CODRUB = RUB.CODRUB",NL," "\
                        "AND IMO.VALRUB = RUB.VALRUB",NL," "\
                        "AND IMO.CODRUB = 'STAG' ",NL," "\
                        "AND IMO.VALCLE = '",tMOTIMM,"'")

		log("------------------------------------------------------------", NL)
		log(tQuery,NL)
		log("------------------------------------------------------------", NL)

		if bfSqlSet(tDbBase, "SELECTdb2", tQuery) = FALSE then
			print("FATAL ", tfSqlErrorStr())
			bfMajtraceBP("Erro de Traducao","1",tNumeroDocumento,tDataDocumento,tFileOut,"M59 - BYPASS",build("Erro na execucao da query ",tQuery," do banco de dados: ",tfSqlErrorStr()))
			exit(1)
		endif

		if bfSqlOpen(tDbBase, "SELECTdb2") = FALSE then
			print("FATAL ", tfSqlErrorStr())
			bfMajtraceBP("Erro de Traducao","1",tNumeroDocumento,tDataDocumento,tFileOut,"M59 - BYPASS",build("Erro na execucao da query ",tQuery," do banco de dados: ",tfSqlErrorStr()))
			exit(1)
		endif

		if bfSqlFetchArray(tDbBase, "SELECTdb2", taDb2Array) = TRUE then
			tLIBVAL := peel(taDb2Array["LIBVAL"]," ")
			remove(taDb2Array)
		endif

		if bfSqlFree(tDbBase, "SELECTdb2") = FALSE then
			print("FATAL", tfSqlErrorStr())
			bfMajtraceBP("Erro de Traducao","1",tNumeroDocumento,tDataDocumento,tFileOut,"M59 - BYPASS",build("Erro na execucao da query ",tQuery," do banco de dados: ",tfSqlErrorStr()))
			exit(1)
		endif

        R_GEEX5990_BP_CODEXC(S_GEEX5990_CODEXC)
        R_GEEX5990_BP_SEPEXC(S_GEEX5990_SEPEXC)
        R_GEEX5990_BP_SCOEXC(S_GEEX5990_SCOEXC)
        R_GEEX5990_BP_TRTEXC(S_GEEX5990_TRTEXC)
        R_GEEX5990_BP_NUMPAL(S_GEEX5990_NUMPAL)
        R_GEEX5990_BP_SNUPAL(S_GEEX5990_SNUPAL)
        R_GEEX5990_BP_CODACT(S_GEEX5990_CODACT)
        R_GEEX5990_BP_CODCLI(S_GEEX5990_CODCLI)
        R_GEEX5990_BP_CODPRO(S_GEEX5990_CODPRO)
        R_GEEX5990_BP_VALPRO(S_GEEX5990_VALPRO)
        R_GEEX5990_BP_CODPAL(S_GEEX5990_CODPAL)
        R_GEEX5990_BP_MOTIMM(S_GEEX5990_MOTIMM)
        R_GEEX5990_BP_DATLIB(S_GEEX5990_DATLIB)
        R_GEEX5990_BP_HEULIB(S_GEEX5990_HEULIB)
        R_GEEX5990_BP_INDLIB(S_GEEX5990_INDLIB)
        R_GEEX5990_BP_IMMBKL(S_GEEX5990_IMMBKL)
        R_GEEX5990_BP_PALIMM(S_GEEX5990_PALIMM)
        R_GEEX5990_BP_DATBKL(S_GEEX5990_DATBKL)
        R_GEEX5990_BP_HEUBKL(S_GEEX5990_HEUBKL)
        R_GEEX5990_BP_DATIMM(S_GEEX5990_DATIMM)
        R_GEEX5990_BP_HEUIMM(S_GEEX5990_HEUIMM)
        R_GEEX5990_BP_DISEXC(S_GEEX5990_DISEXC)
        if length(tMOTIMM) = 0 then
            R_GEEX5990_BP_LIBIMO("Released")
        else
            R_GEEX5990_BP_LIBIMO(tLIBVAL)
        endif
		
		flush(0,0,NL) >> tFileOutTempBP
	!BYPASS FINAL
endline

!==============================================================================

line(1:"99.00")
    ! MASSIFICACAO INICIO
        ! CAMPOS WMS
            tCODEXC9900_MASSIF_Line := S_GEEX9900_BP_CODEXC
            tSEPEXC9900_MASSIF_Line := S_GEEX9900_BP_SEPEXC
            tSCOEXC9900_MASSIF_Line := S_GEEX9900_BP_SCOEXC
            tTRTEXC9900_MASSIF_Line := S_GEEX9900_BP_TRTEXC
            tEMTEXC9900_MASSIF_Line := S_GEEX9900_BP_EMTEXC
            tRCTEXC9900_MASSIF_Line := S_GEEX9900_BP_RCTEXC
            tDATEXC9900_MASSIF_Line := S_GEEX9900_BP_DATEXC
            tHEUEXC9900_MASSIF_Line := S_GEEX9900_BP_HEUEXC
            tNUMEXC9900_MASSIF_Line := S_GEEX9900_BP_NUMEXC
            tCPTEXC9900_MASSIF_Line := S_GEEX9900_BP_CPTEXC
            tNOMSYS9900_MASSIF_Line := S_GEEX9900_BP_NOMSYS
            tNOMDTQ9900_MASSIF_Line := S_GEEX9900_BP_NOMDTQ
            tBIBDTQ9900_MASSIF_Line := S_GEEX9900_BP_BIBDTQ
            tIDEMSG9900_MASSIF_Line := S_GEEX9900_BP_IDEMSG
            tDISEXC9900_MASSIF_Line := S_GEEX9900_BP_DISEXC
        ! FIM CAMPOS WMS
    ! MASSIFICACAO FINAL

	!BYPASS INICIO
		R_GEEX9900_CODEXC(S_GEEX9900_BP_CODEXC)
		R_GEEX9900_SEPEXC(S_GEEX9900_BP_SEPEXC)
		R_GEEX9900_SCOEXC(S_GEEX9900_BP_SCOEXC)
		R_GEEX9900_TRTEXC(S_GEEX9900_BP_TRTEXC)
		R_GEEX9900_EMTEXC(S_GEEX9900_BP_EMTEXC)
		R_GEEX9900_RCTEXC(S_GEEX9900_BP_RCTEXC)
		R_GEEX9900_DATEXC(S_GEEX9900_BP_DATEXC)
		R_GEEX9900_HEUEXC(S_GEEX9900_BP_HEUEXC)
		R_GEEX9900_NUMEXC(S_GEEX9900_BP_NUMEXC)
		R_GEEX9900_CPTEXC(S_GEEX9900_BP_CPTEXC)
		R_GEEX9900_NOMSYS(S_GEEX9900_BP_NOMSYS)
		R_GEEX9900_NOMDTQ(S_GEEX9900_BP_NOMDTQ)
		R_GEEX9900_BIBDTQ(S_GEEX9900_BP_BIBDTQ)
		R_GEEX9900_IDEMSG(S_GEEX9900_BP_IDEMSG)
		R_GEEX9900_DISEXC(S_GEEX9900_BP_DISEXC)

		flush(0,0,NL) >> tFileOutTempBP
	!BYPASS FIM
endline

!==============================================================================

line(1:"99.99")
	!BYPASS INICIO
        R_GEEX9999_BP_CODEXC(S_GEEX9999_CODEXC)
        R_GEEX9999_BP_SEPEXC(S_GEEX9999_SEPEXC)
        R_GEEX9999_BP_SCOEXC(S_GEEX9999_SCOEXC)
        R_GEEX9999_BP_TRTEXC(S_GEEX9999_TRTEXC)
        R_GEEX9999_BP_EMTEXC(S_GEEX9999_EMTEXC)
        R_GEEX9999_BP_RCTEXC(S_GEEX9999_RCTEXC)
        R_GEEX9999_BP_DATEXC(S_GEEX9999_DATEXC)
        R_GEEX9999_BP_HEUEXC(S_GEEX9999_HEUEXC)
        R_GEEX9999_BP_NUMEXC(S_GEEX9999_NUMEXC)
        R_GEEX9999_BP_CPTEXC(S_GEEX9999_CPTEXC)
        R_GEEX9999_BP_ERREXC(S_GEEX9999_ERREXC)
        R_GEEX9999_BP_IDEMSG(S_GEEX9999_IDEMSG)
        R_GEEX9999_BP_DEBFIN(S_GEEX9999_DEBFIN)
        R_GEEX9999_BP_DISEXC(S_GEEX9999_DISEXC)
		
		flush(0,0,NL) >> tFileOutTempBP
	!BYPASS FINAL
endline

!==============================================================================

! Default statements section
default

enddefault

!==============================================================================

! End statements section

end
    ! MASSIFICACAO INICIO
    if bGeraMassificacao then
        while tIndex in taNUMSUP_MASSIF do
            ! QUERY MASSIFICACAO
                nContQueryMassif := 0
                tQuery := build("SELECT  SE.REFLIV",NL," "\
                                "       ,SE.CODPAL       AS CHILD_SSCC",NL," "\
                                "       ,SUM (SD.UVCLIV) AS UVCLIV",NL," "\
                                "       ,SD.PCBPRO",NL," "\
                                "       ,PL.CODPAL",NL," "\
                                "       ,PL.CODLOT",NL," "\
                                "       ,PL.DATFVI",NL," "\
                                "       ,SD.CODPRO",NL," "\
                                "       ,SD.DS1PRO",NL," "\
                                "       ,SD.DS2PRO",NL," "\
                                "FROM FGE50FM",tToInfologPrefixFilename,".GESUPE SE",NL," "\
                                "JOIN FGE50FM",tToInfologPrefixFilename,".GESUPD SD",NL," "\
                                "ON SD.NUMSUP = SE.NUMSUP",NL," "\
                                "JOIN",NL," "\
                                "(",NL," "\
                                "	SELECT  REFLIV",NL," "\
                                "	       ,NUMSUP",NL," "\
                                "	       ,CODPAL",NL," "\
                                "	       ,CODLOT",NL," "\
                                "	       ,DATFVI",NL," "\
                                "	       ,CPTMAS",NL," "\
                                "	FROM FGE50FM",tToInfologPrefixFilename,".GESUPD",NL," "\
                                "	WHERE CPTMAS IN ( SELECT CPTMAS FROM FGE50FM",tToInfologPrefixFilename,".GESUPD WHERE NUMSUP = '",taNUMSUP_MASSIF[tIndex],"')",NL," "\
                                "	AND INDMAS = '3'",NL," "\
                                ") AS PL",NL," "\
                                "ON SD.CPTMAS = PL.CPTMAS",NL," "\
                                "WHERE 1 = 1 ",NL," "\
                                "AND SD.INDMAS = '1'",NL," "\
                                "AND SE.TYPSUP <> '3'",NL," "\
                                "GROUP BY  SE.REFLIV",NL," "\
                                "         ,SE.CODPAL",NL," "\
                                "         ,SD.PCBPRO",NL," "\
                                "         ,PL.CODPAL",NL," "\
                                "         ,PL.CODLOT",NL," "\
                                "         ,PL.DATFVI",NL," "\
                                "         ,SD.CODPRO",NL," "\
                                "         ,SD.DS1PRO",NL," "\
                                "         ,SD.DS2PRO",NL," "\
                                "ORDER BY 1")

                log("------------------------------------------------------------", NL)
                log(tQuery,NL)
                log("------------------------------------------------------------", NL)

                if bfSqlSet(tDbBase, "SELECTdb2", tQuery) = FALSE then
                    print("FATAL ", tfSqlErrorStr())
                    bfMajtraceBP("Erro de Traducao","1",tNumeroDocumento,tDataDocumento,tFileOut,"M59 - BYPASS MASSIFICAÇÃO",build("Erro na execucao da query ",tQuery," do banco de dados: ",tfSqlErrorStr()))
                    exit(1)
                endif

                if bfSqlOpen(tDbBase, "SELECTdb2") = FALSE then
                    print("FATAL ", tfSqlErrorStr())
                    bfMajtraceBP("Erro de Traducao","1",tNumeroDocumento,tDataDocumento,tFileOut,"M59 - BYPASS MASSIFICAÇÃO",build("Erro na execucao da query ",tQuery," do banco de dados: ",tfSqlErrorStr()))
                    exit(1)
                endif

                tREFLIV_Anterior := ""
                tCODPRO_Anterior := ""
                tCODPAL_Anterior := ""
                tCODLOT_Anterior := ""
                tDATFVI_Anterior := ""
                tUVCLIV_Anterior := ""
                while bfSqlFetchArray(tDbBase, "SELECTdb2", taDb2Array) = TRUE do
                    nContQueryMassif++

                    if nContQueryMassif = 1 then
                        tFileOutBP_Massif := build(sHOME,"/mdn/auto/FM",tToInfologPrefixFilename,"MAC_M59_",time("now","%Y%m%d%H%M%S"), strip(peel(taDb2Array["REFLIV"]," "), " "),".DAT")
                        tFileOutTempBP_Massif := build(sHOME,"/mdn/auto/Temp/FM",tToInfologPrefixFilename,"MAC_M59_",time("now","%Y%m%d%H%M%S"), strip(peel(taDb2Array["REFLIV"]," "), " "),".DAT")
                        tNameOutBP_Massif := build("FM",tToInfologPrefixFilename,"MAC_M59_",time("now","%Y%m%d%H%M%S"), strip(peel(taDb2Array["REFLIV"]," "), " "),".DAT")

                        ! LINHA 00.00
                            R_GEEX0000_CODEXC(tCODEXC0000_MASSIF_Line)
                            R_GEEX0000_SEPEXC(tSEPEXC0000_MASSIF_Line)
                            R_GEEX0000_SCOEXC(tSCOEXC0000_MASSIF_Line)
                            R_GEEX0000_TRTEXC(tTRTEXC0000_MASSIF_Line)
                            R_GEEX0000_EMTEXC(tEMTEXC0000_MASSIF_Line)
                            R_GEEX0000_RCTEXC(tRCTEXC0000_MASSIF_Line)
                            R_GEEX0000_DATEXC(tDATEXC0000_MASSIF_Line)
                            R_GEEX0000_HEUEXC(tHEUEXC0000_MASSIF_Line)
                            R_GEEX0000_NUMEXC(tNUMEXC0000_MASSIF_Line)
                            R_GEEX0000_ACQEXC(tACQEXC0000_MASSIF_Line)
                            R_GEEX0000_VEREXC(tVEREXC0000_MASSIF_Line)
                            R_GEEX0000_NOMSYS(tNOMSYS0000_MASSIF_Line)
                            R_GEEX0000_NOMDTQ(tNOMDTQ0000_MASSIF_Line)
                            R_GEEX0000_BIBDTQ(tBIBDTQ0000_MASSIF_Line)
                            R_GEEX0000_LIBEXC(tLIBEXC0000_MASSIF_Line)
                            R_GEEX0000_BIBDST(tBIBDST0000_MASSIF_Line)
                            R_GEEX0000_PGMDST(tPGMDST0000_MASSIF_Line)
                            R_GEEX0000_PARDST(tPARDST0000_MASSIF_Line)
                            R_GEEX0000_CODACT(tCODACT0000_MASSIF_Line)
                            R_GEEX0000_IGLSIT(tIGLSIT0000_MASSIF_Line)
                            R_GEEX0000_EDISIT(tEDISIT0000_MASSIF_Line)
                            R_GEEX0000_IMAEXC(tIMAEXC0000_MASSIF_Line)
                            R_GEEX0000_IDEMSG(tIDEMSG0000_MASSIF_Line)
                            R_GEEX0000_NATEXC(tNATEXC0000_MASSIF_Line)
                            R_GEEX0000_EMTORI(tEMTORI0000_MASSIF_Line)
                            R_GEEX0000_DISEXC(tDISEXC0000_MASSIF_Line)
                            
                            flush(0,0,NL) >> tFileOutTempBP_Massif
                        ! FIM LINHA 00.00

                        bfEscreve59completo(peel(taDb2Array["REFLIV"]," "), \
                                            peel(taDb2Array["CODPAL"]," "), \
                                            peel(taDb2Array["CHILD_SSCC"]," "), \
                                            peel(taDb2Array["UVCLIV"]," "), \
                                            peel(taDb2Array["PCBPRO"]," "), \
                                            peel(taDb2Array["CODLOT"]," "), \
                                            peel(taDb2Array["DATFVI"]," "), \
                                            peel(taDb2Array["CODPRO"]," "), \
                                            peel(taDb2Array["DS1PRO"]," "), \
                                            peel(taDb2Array["DS2PRO"]," "), \
                                            taNUMSUP_MASSIF[tIndex])
                    endif

                    if tREFLIV_Anterior = peel(taDb2Array["REFLIV"]," ") and nContQueryMassif > 1 then
                        if tCODPRO_Anterior <> peel(taDb2Array["CODPRO"]," ") or \
                        tCODPAL_Anterior <> peel(taDb2Array["CODPAL"]," ") or \
                        tCODLOT_Anterior <> peel(taDb2Array["CODLOT"]," ") or \
                        tDATFVI_Anterior <> peel(taDb2Array["DATFVI"]," ") then
                            bfEscreve59detalhe(peel(taDb2Array["REFLIV"]," "), \
                                                peel(taDb2Array["CODPAL"]," "), \
                                                peel(taDb2Array["UVCLIV"]," "), \
                                                peel(taDb2Array["PCBPRO"]," "), \
                                                peel(taDb2Array["CODLOT"]," "), \
                                                peel(taDb2Array["DATFVI"]," "), \
                                                peel(taDb2Array["CODPRO"]," "), \
                                                peel(taDb2Array["DS1PRO"]," "), \
                                                peel(taDb2Array["DS2PRO"]," "), \
                                                taNUMSUP_MASSIF[tIndex])
                        endif
                    else
                        if tREFLIV_Anterior <> peel(taDb2Array["REFLIV"]," ") and nContQueryMassif > 1 then
                            ! LINHA 99.00
                                R_GEEX9900_CODEXC(tCODEXC9900_MASSIF_Line)
                                R_GEEX9900_SEPEXC(tSEPEXC9900_MASSIF_Line)
                                R_GEEX9900_SCOEXC(tSCOEXC9900_MASSIF_Line)
                                R_GEEX9900_TRTEXC(tTRTEXC9900_MASSIF_Line)
                                R_GEEX9900_EMTEXC(tEMTEXC9900_MASSIF_Line)
                                R_GEEX9900_RCTEXC(tRCTEXC9900_MASSIF_Line)
                                R_GEEX9900_DATEXC(tDATEXC9900_MASSIF_Line)
                                R_GEEX9900_HEUEXC(tHEUEXC9900_MASSIF_Line)
                                R_GEEX9900_NUMEXC(tNUMEXC9900_MASSIF_Line)
                                R_GEEX9900_CPTEXC(tCPTEXC9900_MASSIF_Line)
                                R_GEEX9900_NOMSYS(tNOMSYS9900_MASSIF_Line)
                                R_GEEX9900_NOMDTQ(tNOMDTQ9900_MASSIF_Line)
                                R_GEEX9900_BIBDTQ(tBIBDTQ9900_MASSIF_Line)
                                R_GEEX9900_IDEMSG(tIDEMSG9900_MASSIF_Line)
                                R_GEEX9900_DISEXC(tDISEXC9900_MASSIF_Line)

                                flush(0,0,NL) >> tFileOutTempBP_Massif
                            ! FIM LINHA 99.00                        

                            close(tFileOutTempBP_Massif)
                            copy(tFileOutTempBP_Massif,tFileOutBP_Massif)
                            close(tFileOutTempBP_Massif)
                            remove(tFileOutTempBP_Massif)
                            close(tFileOutBP_Massif)

                            bfMajtraceMassif("Recebida", \
                                            "0", \
                                            tREFLIV_Anterior, \
                                            time("now","%Y-%m-%dT%H:%M:%S"), \
                                            tFileOutBP_Massif, \
                                            "M59 - BYPASS MASSIFICAÇÃO", \
                                            "")

                            ! Enviar interface para o cliente
                            tCmd := build("edisend SEND_TO_FMBR ", tFileOutBP_Massif)
                            log("executando o comando - ", tCmd, NL)
                            system(tCmd)  

                            tFileOutBP_Massif := build(sHOME,"/mdn/auto/FM",tToInfologPrefixFilename,"MAC_M59_",time("now","%Y%m%d%H%M%S"), strip(peel(taDb2Array["REFLIV"]," "), " "),".DAT")
                            tFileOutTempBP_Massif := build(sHOME,"/mdn/auto/Temp/FM",tToInfologPrefixFilename,"MAC_M59_",time("now","%Y%m%d%H%M%S"), strip(peel(taDb2Array["REFLIV"]," "), " "),".DAT")
                            tNameOutBP_Massif := build("FM",tToInfologPrefixFilename,"MAC_M59_",time("now","%Y%m%d%H%M%S"), strip(peel(taDb2Array["REFLIV"]," "), " "),".DAT")

                            ! LINHA 00.00
                                R_GEEX0000_CODEXC(tCODEXC0000_MASSIF_Line)
                                R_GEEX0000_SEPEXC(tSEPEXC0000_MASSIF_Line)
                                R_GEEX0000_SCOEXC(tSCOEXC0000_MASSIF_Line)
                                R_GEEX0000_TRTEXC(tTRTEXC0000_MASSIF_Line)
                                R_GEEX0000_EMTEXC(tEMTEXC0000_MASSIF_Line)
                                R_GEEX0000_RCTEXC(tRCTEXC0000_MASSIF_Line)
                                R_GEEX0000_DATEXC(tDATEXC0000_MASSIF_Line)
                                R_GEEX0000_HEUEXC(tHEUEXC0000_MASSIF_Line)
                                R_GEEX0000_NUMEXC(tNUMEXC0000_MASSIF_Line)
                                R_GEEX0000_ACQEXC(tACQEXC0000_MASSIF_Line)
                                R_GEEX0000_VEREXC(tVEREXC0000_MASSIF_Line)
                                R_GEEX0000_NOMSYS(tNOMSYS0000_MASSIF_Line)
                                R_GEEX0000_NOMDTQ(tNOMDTQ0000_MASSIF_Line)
                                R_GEEX0000_BIBDTQ(tBIBDTQ0000_MASSIF_Line)
                                R_GEEX0000_LIBEXC(tLIBEXC0000_MASSIF_Line)
                                R_GEEX0000_BIBDST(tBIBDST0000_MASSIF_Line)
                                R_GEEX0000_PGMDST(tPGMDST0000_MASSIF_Line)
                                R_GEEX0000_PARDST(tPARDST0000_MASSIF_Line)
                                R_GEEX0000_CODACT(tCODACT0000_MASSIF_Line)
                                R_GEEX0000_IGLSIT(tIGLSIT0000_MASSIF_Line)
                                R_GEEX0000_EDISIT(tEDISIT0000_MASSIF_Line)
                                R_GEEX0000_IMAEXC(tIMAEXC0000_MASSIF_Line)
                                R_GEEX0000_IDEMSG(tIDEMSG0000_MASSIF_Line)
                                R_GEEX0000_NATEXC(tNATEXC0000_MASSIF_Line)
                                R_GEEX0000_EMTORI(tEMTORI0000_MASSIF_Line)
                                R_GEEX0000_DISEXC(tDISEXC0000_MASSIF_Line)
                                
                                flush(0,0,NL) >> tFileOutTempBP_Massif
                            ! FIM LINHA 00.00

                            bfEscreve59completo(peel(taDb2Array["REFLIV"]," "), \
                                                peel(taDb2Array["CODPAL"]," "), \
                                                peel(taDb2Array["CHILD_SSCC"]," "), \
                                                peel(taDb2Array["UVCLIV"]," "), \
                                                peel(taDb2Array["PCBPRO"]," "), \
                                                peel(taDb2Array["CODLOT"]," "), \
                                                peel(taDb2Array["DATFVI"]," "), \
                                                peel(taDb2Array["CODPRO"]," "), \
                                                peel(taDb2Array["DS1PRO"]," "), \
                                                peel(taDb2Array["DS2PRO"]," "), \
                                                taNUMSUP_MASSIF[tIndex])
                        endif
                    endif

                    tREFLIV_Anterior := peel(taDb2Array["REFLIV"]," ")
                    tCODPRO_Anterior := peel(taDb2Array["CODPRO"]," ")
                    tCODPAL_Anterior := peel(taDb2Array["CODPAL"]," ")
                    tCODLOT_Anterior := peel(taDb2Array["CODLOT"]," ")
                    tDATFVI_Anterior := peel(taDb2Array["DATFVI"]," ")
                    tUVCLIV_Anterior := peel(taDb2Array["UVCLIV"]," ")
                    
                    ! LOGS
                        log("------------------------------------------------------------", NL)
                        log("tREFLIV_Anterior = ", tREFLIV_Anterior, NL)
                        log("tCODPRO_Anterior = ", tCODPRO_Anterior, NL)
                        log("tCODPAL_Anterior = ", tCODPAL_Anterior, NL)
                        log("tCODLOT_Anterior = ", tCODLOT_Anterior, NL)
                        log("tDATFVI_Anterior = ", tDATFVI_Anterior, NL)
                        log("tUVCLIV_Anterior = ", tDATFVI_Anterior, NL)
                        log("------------------------------------------------------------", NL)
                    ! FIM LOGS
                    remove(taDb2Array)
                endwhile

                ! LINHA 99.00
                    R_GEEX9900_CODEXC(tCODEXC9900_MASSIF_Line)
                    R_GEEX9900_SEPEXC(tSEPEXC9900_MASSIF_Line)
                    R_GEEX9900_SCOEXC(tSCOEXC9900_MASSIF_Line)
                    R_GEEX9900_TRTEXC(tTRTEXC9900_MASSIF_Line)
                    R_GEEX9900_EMTEXC(tEMTEXC9900_MASSIF_Line)
                    R_GEEX9900_RCTEXC(tRCTEXC9900_MASSIF_Line)
                    R_GEEX9900_DATEXC(tDATEXC9900_MASSIF_Line)
                    R_GEEX9900_HEUEXC(tHEUEXC9900_MASSIF_Line)
                    R_GEEX9900_NUMEXC(tNUMEXC9900_MASSIF_Line)
                    R_GEEX9900_CPTEXC(tCPTEXC9900_MASSIF_Line)
                    R_GEEX9900_NOMSYS(tNOMSYS9900_MASSIF_Line)
                    R_GEEX9900_NOMDTQ(tNOMDTQ9900_MASSIF_Line)
                    R_GEEX9900_BIBDTQ(tBIBDTQ9900_MASSIF_Line)
                    R_GEEX9900_IDEMSG(tIDEMSG9900_MASSIF_Line)
                    R_GEEX9900_DISEXC(tDISEXC9900_MASSIF_Line)

                    flush(0,0,NL) >> tFileOutTempBP_Massif
                ! FIM LINHA 99.00

                close(tFileOutTempBP_Massif)
                copy(tFileOutTempBP_Massif,tFileOutBP_Massif)
                close(tFileOutTempBP_Massif)
                remove(tFileOutTempBP_Massif)
                close(tFileOutBP_Massif)

                bfMajtraceMassif("Recebida", \
                                "0", \
                                tREFLIV_Anterior, \
                                time("now","%Y-%m-%dT%H:%M:%S"), \
                                tFileOutBP_Massif, \
                                "M59 - BYPASS MASSIFICAÇÃO", \
                                "")

                ! Enviar interface para o cliente
                tCmd := build("edisend SEND_TO_FMBR ", tFileOutBP_Massif)
                log("executando o comando - ", tCmd, NL)
                system(tCmd) 

                if bfSqlFree(tDbBase, "SELECTdb2") = FALSE then
                    print("FATAL", tfSqlErrorStr())
                    bfMajtraceBP("Erro de Traducao","1",tNumeroDocumento,tDataDocumento,tFileOut,"M59 - BYPASS MASSIFICAÇÃO",build("Erro na execucao da query ",tQuery," do banco de dados: ",tfSqlErrorStr()))
                    exit(1)
                endif
                ! FIM QUERY MASSIFICACAO

                ! QUERY MASSIFICACAO GELIRUB
                tQuery := build("SELECT DISTINCT SE.NUMLIV",NL," "\
                                "       ,SE.SNULIV",NL," "\
                                "       ,SE.REFLIV",NL," "\
                                "       ,SE.CODPAL            AS VALRUB",NL," "\
                                "       ,SE.MAJCRE           AS MAJCRE",NL," "\
                                "       ,SE.MAJDAT           AS MAJDAT",NL," "\
                                "       ,LPAD(SE.MAJHMS,6,0) AS MAJHMS",NL," "\
                                "FROM FGE50FM",tToInfologPrefixFilename,".GESUPD SD",NL," "\
                                "JOIN FGE50FM",tToInfologPrefixFilename,".GESUPE SE",NL," "\
                                "ON SD.NUMSUP = SE.NUMSUP",NL," "\
                                "WHERE SD.CPTMAS IN ( SELECT CPTMAS FROM FGE50FM",tToInfologPrefixFilename,".GESUPD WHERE NUMSUP = '",taNUMSUP_MASSIF[tIndex],"')",NL," "\
                                "AND SD.INDMAS = '1'",NL," "\
                                "AND SE.TYPSUP <> '3'")

                log("------------------------------------------------------------", NL)
                log(tQuery,NL)
                log("------------------------------------------------------------", NL)

                if bfSqlSet(tDbBase, "SELECTdb2", tQuery) = FALSE then
                    print("FATAL ", tfSqlErrorStr())
                    bfMajtraceBP("Erro de Traducao","1",tNumeroDocumento,tDataDocumento,tFileOut,"M59 - BYPASS MASSIFICAÇÃO GELIRUB",build("Erro na execucao da query ",tQuery," do banco de dados: ",tfSqlErrorStr()))
                    exit(1)
                endif

                if bfSqlOpen(tDbBase, "SELECTdb2") = FALSE then
                    print("FATAL ", tfSqlErrorStr())
                    bfMajtraceBP("Erro de Traducao","1",tNumeroDocumento,tDataDocumento,tFileOut,"M59 - BYPASS MASSIFICAÇÃO GELIRUB",build("Erro na execucao da query ",tQuery," do banco de dados: ",tfSqlErrorStr()))
                    exit(1)
                endif

                while bfSqlFetchArray(tDbBase, "SELECTdb2", taDb2Array) = TRUE do
                    tNUMLIV_GELIRUB := peel(taDb2Array["NUMLIV"]," ")
                    tSNULIV_GELIRUB := peel(taDb2Array["SNULIV"]," ")
                    tREFLIV_GELIRUB := peel(taDb2Array["REFLIV"]," ")
                    tVALRUB_GELIRUB := peel(taDb2Array["VALRUB"]," ")
                    tMAJCRE_GELIRUB := peel(taDb2Array["MAJCRE"]," ")
                    tMAJDAT_GELIRUB := peel(taDb2Array["MAJDAT"]," ")
                    tMAJHMS_GELIRUB := peel(taDb2Array["MAJHMS"]," ")

                    tFileOutCSV := build(sHOME,"/ToInfolog/I-FGE50FM",tToInfologPrefixFilename,"GELIRUB_MAC_",time("now" ,"%Y%m%d"),"_",tREFLIV_GELIRUB,".DAT")
                    tFileOutTempCSV := build(sHOME,"/ToInfolog/Temp/I-FGE50FM",tToInfologPrefixFilename,"GELIRUB_MAC_",time("now" ,"%Y%m%d"),"_",tREFLIV_GELIRUB,".DAT")
                    tNameOutCSV := build("I-FGE50FM",tToInfologPrefixFilename,"GELIRUB_MAC_",time("now" ,"%Y%m%d"),"_",tREFLIV_GELIRUB,".DAT")

                    print("NUMLIV;SNULIV;TYPRUB;CODRUB;VALRUB;VALNUM;DISPO;MAJCRE;MAJDAT;MAJHMS;MAJPGM;MAJUTI;MAJECR",NL) >> tFileOutTempCSV

                    tNUMLIVCSV := tNUMLIV_GELIRUB
                    tSNULIVCSV := tSNULIV_GELIRUB
                    tTYPRUBCSV := "2"
                    tCODRUBCSV := "SSCC"
                    tVALRUBCSV := tVALRUB_GELIRUB
                    tVALNUMCSV := "0"
                    tDISPOCSV  := ""
                    tMAJCRECSV := tMAJCRE_GELIRUB
                    tMAJDATCSV := tMAJDAT_GELIRUB
                    tMAJHMSCSV := tMAJHMS_GELIRUB
                    tMAJPGMCSV := "GEEX160B"
                    tMAJUTICSV := build("UFM",tToInfologPrefixFilename)
                    tMAJECRCSV := "DTQ_M50"

                    print(tNUMLIVCSV,";", \
                            tSNULIVCSV,";", \
                            tTYPRUBCSV,";", \
                            tCODRUBCSV,";", \
                            tVALRUBCSV,";", \
                            tVALNUMCSV,";", \
                            tDISPOCSV,";", \
                            tMAJCRECSV,";", \
                            tMAJDATCSV,";", \
                            tMAJHMSCSV,";", \
                            tMAJPGMCSV,";", \
                            tMAJUTICSV,";", \
                            tMAJECRCSV,";", NL) >> tFileOutTempCSV	

                    
                    close(tFileOutTempCSV)
                    copy(tFileOutTempCSV,tFileOutCSV)
                    close(tFileOutTempCSV)
                    remove(tFileOutTempCSV)
                    close(tFileOutCSV)

                    bfMajtraceMassifGELIRUB("Recebida", \
                                            "0", \
                                            tREFLIV_GELIRUB, \
                                            time("now","%Y-%m-%dT%H:%M:%S"), \
                                            tFileOutCSV, \
                                            "M59 - BYPASS MASSIFICAÇÃO GELIRUB", \
                                            "")

                    ! LOGS
                        log("------------------------------------------------------------", NL)
                        log("tNUMLIV_GELIRUB = ", tNUMLIV_GELIRUB, NL)
                        log("tSNULIV_GELIRUB = ", tSNULIV_GELIRUB, NL)
                        log("tVALRUB_GELIRUB = ", tVALRUB_GELIRUB, NL)
                        log("tMAJCRE_GELIRUB = ", tMAJCRE_GELIRUB, NL)
                        log("tMAJDAT_GELIRUB = ", tMAJDAT_GELIRUB, NL)
                        log("tMAJHMS_GELIRUB = ", tMAJHMS_GELIRUB, NL)
                        log("------------------------------------------------------------", NL)
                    ! FIM LOGS
                    remove(taDb2Array)
                endwhile

                if bfSqlFree(tDbBase, "SELECTdb2") = FALSE then
                    print("FATAL", tfSqlErrorStr())
                    bfMajtraceBP("Erro de Traducao","1",tNumeroDocumento,tDataDocumento,tFileOut,"M59 - BYPASS MASSIFICAÇÃO GELIRUB",build("Erro na execucao da query ",tQuery," do banco de dados: ",tfSqlErrorStr()))
                    exit(1)
                endif
            ! FIM QUERY MASSIFICACAO GELIRUB
        endwhile
    endif
    ! MASSIFICACAO FINAL

    !BYPASS INICIO
    if bGeraByPASS = TRUE then
        close(tFileOutTempBP)
        copy(tFileOutTempBP,tFileOutBP)
        close(tFileOutTempBP)
        remove(tFileOutTempBP)
        close(tFileOutBP)

        bfMajtraceBP("Recebida", \
                    "0", \
                    "M59 - BYPASS", \
                    time("now","%Y-%m-%dT%H:%M:%S"), \
                    tFileOut, \
                    "M59 - BYPASS", \
                    "")

        ! Enviar interface para o cliente
        tCmd := build("edisend SEND_TO_FMBR ", tFileOutBP)
        log("executando o comando - ", tCmd, NL)
        system(tCmd) 
    else
        remove(tFileOutTempBP)
        remove(tFileOutBP)
    endif
    !BYPASS FINAL

    close(tDbBase)
    exit(0)
endend

!==============================================================================

function bfMajtraceBP(tStatus,tError,tNumDoc,tDataDoc,tFileOut,tMensagem,tMensagemErro)
	TRACE:=new(build(sHOME,"/trace"))
	TRACE.ESTADO := tStatus
	TRACE.ERRO := tError
	TRACE.DATATRADUCAO := time("now","%Y-%m-%dT%H:%M:%S")
	TRACE.MENSAGEM := tMensagem
	TRACE.PERFIL := "MARS CAJAMAR"
	TRACE.SENTIDO := "I"
	TRACE.NUMDOC := tNumDoc
	TRACE.DATDOC := tDataDoc
	TRACE.MESSAGEID := build(nMessageID)   
	if pEDISEND.ORIGINAL.NAME <> build(SYSLOG.INDEX) then
		TRACE.REDE := pEDISEND.ORIGINAL.NAME
	else
		TRACE.REDE := "REPROCESSADO"
	endif
	TRACE.SYSLOG_INDEX := build(SYSLOG.INDEX)
	TRACE.FICHEIROSAIDA := tNameOutBP

	SYSLOG.REFERENCE := build(nMessageID)

	if tStatus = "Recebida" then
		print(build("Ficheiro de Saida: "),tFileOutBP,NL,NL) >> TRACE.Detail
		print(build(time("now" ,"%Y-%m-%dT%H:%M:%S"),"\t|\t")) >> TRACE.Detail
		print("Traduzida com Sucesso",NL) >> TRACE.Detail
	else
		if tStatus = "Erro de Traducao" then
			print(build(time("now" ,"%Y-%m-%dT%H:%M:%S"),"\t|\t")) >> TRACE.Detail
			print("Erro de Traducao",NL) >> TRACE.Detail
			print(tMensagemErro,NL, NL) >> TRACE.Detail
		endif
	endif

	close(TRACE.Detail)
	
	if nMainIndex = 0 then
		close(SYSLOG.a)
		copy(SYSLOG.a,TRACE.In)
		close(SYSLOG.a)
		close(TRACE.In)
		nMainIndex := TRACE.INDEX
	else
		tCmd := build("ln -s ", sHOME, "/trace/files/In/", nMainIndex, " ", TRACE.In)
		system(tCmd)
	endif

	if tError = "0" then
		close(tFileOutBP)
		copy(tFileOutBP,TRACE.Out)
		close(tFileOutBP)
		close(TRACE.Out)
	endif

	flush(TRACE)
endfunction

!==============================================================================

function bfMajtraceMassif(tStatus,tError,tNumDoc,tDataDoc,tFileOut,tMensagem,tMensagemErro)
	TRACE:=new(build(sHOME,"/trace"))
	TRACE.ESTADO := tStatus
	TRACE.ERRO := tError
	TRACE.DATATRADUCAO := time("now","%Y-%m-%dT%H:%M:%S")
	TRACE.MENSAGEM := tMensagem
	TRACE.PERFIL := "MARS CAJAMAR"
	TRACE.SENTIDO := "I"
	TRACE.NUMDOC := tNumDoc
	TRACE.DATDOC := tDataDoc
	TRACE.MESSAGEID := build(nMessageID)   
	if pEDISEND.ORIGINAL.NAME <> build(SYSLOG.INDEX) then
		TRACE.REDE := pEDISEND.ORIGINAL.NAME
	else
		TRACE.REDE := "REPROCESSADO"
	endif
	TRACE.SYSLOG_INDEX := build(SYSLOG.INDEX)
	TRACE.FICHEIROSAIDA := tNameOutBP_Massif

	SYSLOG.REFERENCE := build(nMessageID)

	if tStatus = "Recebida" then
		print(build("Ficheiro de Saida: "),tFileOutBP_Massif,NL,NL) >> TRACE.Detail
		print(build(time("now" ,"%Y-%m-%dT%H:%M:%S"),"\t|\t")) >> TRACE.Detail
		print("Traduzida com Sucesso",NL) >> TRACE.Detail
	else
		if tStatus = "Erro de Traducao" then
			print(build(time("now" ,"%Y-%m-%dT%H:%M:%S"),"\t|\t")) >> TRACE.Detail
			print("Erro de Traducao",NL) >> TRACE.Detail
			print(tMensagemErro,NL, NL) >> TRACE.Detail
		endif
	endif

	close(TRACE.Detail)
	
	if nMainIndex = 0 then
		close(SYSLOG.a)
		copy(SYSLOG.a,TRACE.In)
		close(SYSLOG.a)
		close(TRACE.In)
		nMainIndex := TRACE.INDEX
	else
		tCmd := build("ln -s ", sHOME, "/trace/files/In/", nMainIndex, " ", TRACE.In)
		system(tCmd)
	endif

	if tError = "0" then
		close(tFileOutBP_Massif)
		copy(tFileOutBP_Massif,TRACE.Out)
		close(tFileOutBP_Massif)
		close(TRACE.Out)
	endif

	flush(TRACE)
endfunction

!==============================================================================

function bfMajtraceMassifGELIRUB(tStatus,tError,tNumDoc,tDataDoc,tFileOut,tMensagem,tMensagemErro)
	TRACE:=new(build(sHOME,"/trace"))
	TRACE.ESTADO := tStatus
	TRACE.ERRO := tError
	TRACE.DATATRADUCAO := time("now","%Y-%m-%dT%H:%M:%S")
	TRACE.MENSAGEM := tMensagem
	TRACE.PERFIL := "MARS CAJAMAR"
	TRACE.SENTIDO := "I"
	TRACE.NUMDOC := tNumDoc
	TRACE.DATDOC := tDataDoc
	TRACE.MESSAGEID := build(nMessageID)   
	if pEDISEND.ORIGINAL.NAME <> build(SYSLOG.INDEX) then
		TRACE.REDE := pEDISEND.ORIGINAL.NAME
	else
		TRACE.REDE := "REPROCESSADO"
	endif
	TRACE.SYSLOG_INDEX := build(SYSLOG.INDEX)
	TRACE.FICHEIROSAIDA := tNameOutCSV

	SYSLOG.REFERENCE := build(nMessageID)

	if tStatus = "Recebida" then
		print(build("Ficheiro de Saida: "),tFileOutCSV,NL,NL) >> TRACE.Detail
		print(build(time("now" ,"%Y-%m-%dT%H:%M:%S"),"\t|\t")) >> TRACE.Detail
		print("Traduzida com Sucesso",NL) >> TRACE.Detail
	else
		if tStatus = "Erro de Traducao" then
			print(build(time("now" ,"%Y-%m-%dT%H:%M:%S"),"\t|\t")) >> TRACE.Detail
			print("Erro de Traducao",NL) >> TRACE.Detail
			print(tMensagemErro,NL, NL) >> TRACE.Detail
		endif
	endif

	close(TRACE.Detail)
	
	if nMainIndex = 0 then
		close(SYSLOG.a)
		copy(SYSLOG.a,TRACE.In)
		close(SYSLOG.a)
		close(TRACE.In)
		nMainIndex := TRACE.INDEX
	else
		tCmd := build("ln -s ", sHOME, "/trace/files/In/", nMainIndex, " ", TRACE.In)
		system(tCmd)
	endif

	if tError = "0" then
		close(tFileOutCSV)
		copy(tFileOutCSV,TRACE.Out)
		close(tFileOutCSV)
		close(TRACE.Out)
	endif

	flush(TRACE)
endfunction

!==============================================================================

function bfEscreve59completo(tREFLIV_Maj, tCODPAL_Maj, tCODPAL_Maj2, tUVCLIV_Maj, tPCBPRO_Maj, tCODLOT_Maj, tDATFVI_Maj, tCODPRO_Maj, tDS1PRO_Maj, tDS2PRO_Maj, tNUMSUP_Maj)
    ! LINHA 59.20
        R_GEEX5920_BP_CODEXC("59")
        R_GEEX5920_BP_SEPEXC(".")
        R_GEEX5920_BP_SCOEXC("20")
        R_GEEX5920_BP_TRTEXC(taTRTEXC5920_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5920_BP_NUMSUP(taNUMSUP5920_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5920_BP_SNUSUP(taSNUSUP5920_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5920_BP_TYPSUP(taTYPSUP5920_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5920_BP_ETASUP(taETASUP5920_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5920_BP_LIBSUP(taLIBSUP5920_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5920_BP_CODEMB(taCODEMB5920_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5920_BP_CODUOP(taCODUOP5920_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5920_BP_EMBUOP(taEMBUOP5920_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5920_BP_EMBTOU(taEMBTOU5920_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5920_BP_TOPBDL(taTOPBDL5920_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5920_BP_AIGALC(taAIGALC5920_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5920_BP_AIGPRI(taAIGPRI5920_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5920_BP_AIGPVA(taAIGPVA5920_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5920_BP_NBRPVA(taNBRPVA5920_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5920_BP_DATPRP(taDATPRP5920_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5920_BP_NUMVAG(taNUMVAG5920_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5920_BP_NUMTOU(taNUMTOU5920_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5920_BP_DATLIV(taDATLIV5920_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5920_BP_TOULIV(taTOULIV5920_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5920_BP_NSTLIV(taNSTLIV5920_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5920_BP_ORDLIV(taORDLIV5920_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5920_BP_KAILIV(taKAILIV5920_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5920_BP_NUMLIV(taNUMLIV5920_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5920_BP_SNULIV(taSNULIV5920_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5920_BP_CODACL(taCODACL5920_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5920_BP_REFLIV(tREFLIV_Maj)
        R_GEEX5920_BP_ORICDE(taORICDE5920_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5920_BP_CLILIV(taCLILIV5920_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5920_BP_NOMCLI(taNOMCLI5920_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5920_BP_CUMPOI(taCUMPOI5920_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5920_BP_CUMVOL(taCUMVOL5920_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5920_BP_CUMCOL(taCUMCOL5920_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5920_BP_CUMLIG(taCUMLIG5920_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5920_BP_CUMPRT(taCUMPRT5920_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5920_BP_CUMEQP(taCUMEQP5920_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5920_BP_DISEXC(taDISEXC5920_MASSIF_Line[tNUMSUP_Maj])

        flush(0,0,NL) >> tFileOutTempBP_Massif
    ! FIM LINHA 59.20

    ! LINHA 59.21
        R_GEEX5921_BP_CODEXC("59")
        R_GEEX5921_BP_SEPEXC(".")
        R_GEEX5921_BP_SCOEXC("21")
        R_GEEX5921_BP_TRTEXC(taTRTEXC5921_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5921_BP_TPSPRT(taTPSPRT5921_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5921_BP_CUMUOT(taCUMUOT5921_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5921_BP_CODPRP(taCODPRP5921_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5921_BP_CARDES(taCARDES5921_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5921_BP_DATSUP(taDATSUP5921_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5921_BP_HEUSUP(taHEUSUP5921_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5921_BP_NUMPAL(taNUMPAL5921_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5921_BP_SNUPAL(taSNUPAL5921_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5921_BP_CODPAL(tCODPAL_Maj2)
        R_GEEX5921_BP_ETADES(taETADES5921_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5921_BP_PTYDES(taPTYDES5921_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5921_BP_ZONSTS(taZONSTS5921_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5921_BP_ALLSTS(taALLSTS5921_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5921_BP_DPLSTS(taDPLSTS5921_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5921_BP_NIVSTS(taNIVSTS5921_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5921_BP_CODACT(taCODACT5921_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5921_BP_CODPRO(tCODPRO_Maj)
        R_GEEX5921_BP_VALPRO(taVALPRO5921_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5921_BP_SPCPRO(taSPCPRO5921_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5921_BP_PCBPRO(tPCBPRO_Maj)
        R_GEEX5921_BP_CIRPIC(taCIRPIC5921_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5921_BP_NUMPIC(taNUMPIC5921_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5921_BP_PRPPIC(taPRPPIC5921_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5921_BP_ZONPIC(taZONPIC5921_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5921_BP_ALLPIC(taALLPIC5921_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5921_BP_DPLPIC(taDPLPIC5921_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5921_BP_NIVPIC(taNIVPIC5921_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5921_BP_ZONREA(taZONREA5921_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5921_BP_ALLREA(taALLREA5921_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5921_BP_DPLREA(taDPLREA5921_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5921_BP_NIVREA(taNIVREA5921_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5921_BP_TRTCLS(taTRTCLS5921_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5921_BP_TOPCLS(taTOPCLS5921_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5921_BP_ERRCLS(taERRCLS5921_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5921_BP_TRTUOP(taTRTUOP5921_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5921_BP_TOPUOP(taTOPUOP5921_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5921_BP_ERRUOP(taERRUOP5921_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5921_BP_TRTPRP(taTRTPRP5921_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5921_BP_TOPPRP(taTOPPRP5921_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5921_BP_ERRPRP(taERRPRP5921_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5921_BP_TRTTOU(taTRTTOU5921_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5921_BP_TOPTOU(taTOPTOU5921_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5921_BP_ERRTOU(taERRTOU5921_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5921_BP_CNFSUP(taCNFSUP5921_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5921_BP_TOPHIS(taTOPHIS5921_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5921_BP_CUMLOG(taCUMLOG5921_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5921_BP_DATLIM(taDATLIM5921_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5921_BP_HEULIM(taHEULIM5921_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5921_BP_TOPMNQ(taTOPMNQ5921_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5921_BP_PTYORI(taPTYORI5921_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5921_BP_NUMTOI(taNUMTOI5921_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5921_BP_NUMCNT(taNUMCNT5921_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5921_BP_CODSTL(taCODSTL5921_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5921_BP_DISEXC(taDISEXC5921_MASSIF_Line[tNUMSUP_Maj])

        flush(0,0,NL) >> tFileOutTempBP_Massif
    ! FIM LINHA 59.21

    ! LINHA 59.22
        R_GEEX5922_CODEXC("59")
        R_GEEX5922_SEPEXC(".")
        R_GEEX5922_SCOEXC("22")
        R_GEEX5922_TRTEXC(taTRTEXC5922_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5922_CODLDP(taCODLDP5922_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5922_CODCMP(taCODCMP5922_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5922_NUMCMP(taNUMCMP5922_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5922_SNUCMP(taSNUCMP5922_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5922_NIVITR(taNIVITR5922_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5922_TOPETI(taTOPETI5922_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5922_CATREF(taCATREF5922_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5922_INDCHT(taINDCHT5922_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5922_NBRDAT(taNBRDAT5922_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5922_ORDEMB(taORDEMB5922_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5922_TOPPAQ(taTOPPAQ5922_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5922_NUMPLB(taNUMPLB5922_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5922_PDBEMB(taPDBEMB5922_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5922_SSCCMP(taSSCCMP5922_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5922_DATPAK(taDATPAK5922_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5922_HEUPAK(taHEUPAK5922_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5922_POITOT(taPOITOT5922_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5922_NUMTKG(taNUMTKG5922_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5922_NUMTKR(taNUMTKR5922_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5922_DISEXC(taDISEXC5922_MASSIF_Line[tNUMSUP_Maj])

        flush(0,0,NL) >> tFileOutTempBP_Massif
    ! FIM LINHA 59.22

    ! LINHA 59.29
        R_GEEX5929_CODEXC("59")
        R_GEEX5929_SEPEXC(".")
        R_GEEX5929_SCOEXC("29")
        R_GEEX5929_TRTEXC(taTRTEXC5929_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5929_LIBVAG(taLIBVAG5929_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5929_LIBCIR(taLIBCIR5929_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5929_TYPLIV(taTYPLIV5929_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5929_VOLUOP(taVOLUOP5929_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5929_EDISIT(taEDISIT5929_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5929_EDICLI(taEDICLI5929_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5929_TYPACT(taTYPACT5929_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5929_REFMIT(taREFMIT5929_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5929_NUMREC(taNUMREC5929_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5929_SNUREC(taSNUREC5929_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5929_TYPCIR(taTYPCIR5929_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5929_CODTLI(taCODTLI5929_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5929_DISEXC(taDISEXC5929_MASSIF_Line[tNUMSUP_Maj])

        flush(0,0,NL) >> tFileOutTempBP_Massif
    ! FIM LINHA 59.29

    ! LINHA 59.40  
        R_GEEX5940_BP_CODEXC("59")
        R_GEEX5940_BP_SEPEXC(".")
        R_GEEX5940_BP_SCOEXC("40")
        R_GEEX5940_BP_TRTEXC(taTRTEXC5940_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5940_BP_NUMSUP(taNUMSUP5940_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5940_BP_SNUSUP(taSNUSUP5940_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5940_BP_SEQSUP(taSEQSUP5940_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5940_BP_NUMLIV(taNUMLIV5940_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5940_BP_SNULIV(taSNULIV5940_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5940_BP_SEQLIV(taSEQLIV5940_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5940_BP_TOPLIV(taTOPLIV5940_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5940_BP_CODCLI(taCODCLI5940_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5940_BP_CLILIV(taCLILIV5940_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5940_BP_CODACT(taCODACT5940_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5940_BP_CODPRO(tCODPRO_Maj)
        R_GEEX5940_BP_VALPRO(taVALPRO5940_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5940_BP_VAPPRO(taVAPPRO5940_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5940_BP_DS1PRO(tDS1PRO_Maj)
        R_GEEX5940_BP_DS2PRO(tDS2PRO_Maj)
        R_GEEX5940_BP_FAMPRO(taFAMPRO5940_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5940_BP_ANAPRO(taANAPRO5940_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5940_BP_UNIPRO(taUNIPRO5940_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5940_BP_MESPRO(taMESPRO5940_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5940_BP_PDBCOL(taPDBCOL5940_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5940_BP_VOLCOL(taVOLCOL5940_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5940_BP_COECOL(taCOECOL5940_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5940_BP_CODALC(taCODALC5940_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5940_BP_DEGALC(taDEGALC5940_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5940_BP_VOLALC(taVOLALC5940_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5940_BP_CODEAP(taCODEAP5940_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5940_BP_CODPRN(taCODPRN5940_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5940_BP_EDIPRO(taEDIPRO5940_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5940_BP_UNICDE(taUNICDE5940_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5940_BP_CVTUVC(taCVTUVC5940_MASSIF_Line[tNUMSUP_Maj])

        flush(0,0,NL) >> tFileOutTempBP_Massif
    ! FIM LINHA 59.40

    ! LINHA 59.41
        R_GEEX5941_BP_CODEXC("59")
        R_GEEX5941_BP_SEPEXC(".")
        R_GEEX5941_BP_SCOEXC("41")
        R_GEEX5941_BP_TRTEXC(taTRTEXC5941_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5941_BP_TYPSTK(taTYPSTK5941_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5941_BP_AIGPRI(taAIGPRI5941_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5941_BP_PRILIV(taPRILIV5941_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5941_BP_TYPOPE(taTYPOPE5941_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5941_BP_NUMOPE(taNUMOPE5941_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5941_BP_MSGLIG(taMSGLIG5941_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5941_BP_DIPLIV(taDIPLIV5941_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5941_BP_NLILIV(taNLILIV5941_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5941_BP_PRPPIC(taPRPPIC5941_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5941_BP_ZONPIC(taZONPIC5941_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5941_BP_ALLPIC(taALLPIC5941_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5941_BP_DPLPIC(taDPLPIC5941_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5941_BP_NIVPIC(taNIVPIC5941_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5941_BP_NUMPIC(taNUMPIC5941_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5941_BP_UVCCDE(taUVCCDE5941_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5941_BP_UVCSRV(taUVCSRV5941_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5941_BP_UVCLIV(tUVCLIV_Maj)
        R_GEEX5941_BP_PDNLIV(taPDNLIV5941_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5941_BP_SPCPRO(taSPCPRO5941_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5941_BP_PCBPRO(tPCBPRO_Maj)
        R_GEEX5941_BP_COLCOU(taCOLCOU5941_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5941_BP_COUPAL(taCOUPAL5941_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5941_BP_GERPAL(taGERPAL5941_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5941_BP_GERHAU(taGERHAU5941_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5941_BP_NUMPAL(taNUMPAL5941_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5941_BP_SNUPAL(taSNUPAL5941_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5941_BP_CODPAL(tCODPAL_Maj)
        R_GEEX5941_BP_NUMLOT(taNUMLOT5941_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5941_BP_CODLOT(tCODLOT_Maj)
        R_GEEX5941_BP_DATFVI(tDATFVI_Maj)
        R_GEEX5941_BP_DISEXC(taDISEXC5941_MASSIF_Line[tNUMSUP_Maj])
        
        flush(0,0,NL) >> tFileOutTempBP_Massif
    ! FIM LINHA 59.41
    
    ! LINHA 59.42
        R_GEEX5942_BP_CODEXC("59")
        R_GEEX5942_BP_SEPEXC(".")
        R_GEEX5942_BP_SCOEXC("42")
        R_GEEX5942_BP_TRTEXC(taTRTEXC5942_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5942_BP_ZONSTS(taZONSTS5942_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5942_BP_ALLSTS(taALLSTS5942_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5942_BP_DPLSTS(taDPLSTS5942_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5942_BP_NIVSTS(taNIVSTS5942_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5942_BP_CODACL(taCODACL5942_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5942_BP_MOTMVT(taMOTMVT5942_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5942_BP_ZONORI(taZONORI5942_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5942_BP_ALLORI(taALLORI5942_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5942_BP_DPLORI(taDPLORI5942_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5942_BP_NIVORI(taNIVORI5942_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5942_BP_UVCMNQ(taUVCMNQ5942_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5942_BP_PDNUVC(taPDNUVC5942_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5942_BP_NUMCLS(taNUMCLS5942_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5942_BP_CODCLS(taCODCLS5942_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5942_BP_NUMRPT(taNUMRPT5942_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5942_BP_SNURPT(taSNURPT5942_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5942_BP_TOPRPT(taTOPRPT5942_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5942_BP_COELOG(taCOELOG5942_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5942_BP_CNFLIG(taCNFLIG5942_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5942_BP_UVCDIF(taUVCDIF5942_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5942_BP_PDBUVC(taPDBUVC5942_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5942_BP_REFLIV(tREFLIV_Maj)
        R_GEEX5942_BP_UVCEMB(taUVCEMB5942_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5942_BP_MAJPOI(taMAJPOI5942_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5942_BP_STKOUV(taSTKOUV5942_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5942_BP_CODSUP(taCODSUP5942_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5942_BP_DATFAB(taDATFAB5942_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5942_BP_VLDDAT(taVLDDAT5942_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5942_BP_TOPCOL(taTOPCOL5942_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5942_BP_VTLSEQ(taVTLSEQ5942_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5942_BP_REFORI(taREFORI5942_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5942_BP_CODOPE(taCODOPE5942_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5942_BP_NUMORI(taNUMORI5942_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5942_BP_SNUORI(taSNUORI5942_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5942_BP_DISEXC(taDISEXC5942_MASSIF_Line[tNUMSUP_Maj])

        flush(0,0,NL) >> tFileOutTempBP_Massif
    ! FIM LINHA 59.42

    ! LINHA 59.45
        R_GEEX5945_BP_CODEXC("59")
        R_GEEX5945_BP_SEPEXC(".")
        R_GEEX5945_BP_SCOEXC("45")
        R_GEEX5945_BP_TRTEXC(taTRTEXC5945_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5945_BP_NUMLIV(taNUMLIV5945_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5945_BP_SNULIV(taSNULIV5945_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5945_BP_REFLIV(tREFLIV_Maj)
        R_GEEX5945_BP_NLILIV(taNLILIV5945_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5945_BP_CODACT(taCODACT5945_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5945_BP_CODCLI(taCODCLI5945_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5945_BP_CODPRO(tCODPRO_Maj)
        R_GEEX5945_BP_VALPRO(taVALPRO5945_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5945_BP_DS1PRO(tDS1PRO_Maj)
        R_GEEX5945_BP_DS2PRO(tDS2PRO_Maj)
        R_GEEX5945_BP_DS3PRO(taDS3PRO5945_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5945_BP_FAMPRO(taFAMPRO5945_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5945_BP_DISEXC(taDISEXC5945_MASSIF_Line[tNUMSUP_Maj])

        flush(0,0,NL) >> tFileOutTempBP_Massif
    ! FIM LINHA 59.45

    ! LINHA 59.90
        R_GEEX5990_BP_CODEXC("59")
        R_GEEX5990_BP_SEPEXC(".")
        R_GEEX5990_BP_SCOEXC("90")
        R_GEEX5990_BP_TRTEXC(taTRTEXC5990_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5990_BP_NUMPAL(taNUMPAL5990_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5990_BP_SNUPAL(taSNUPAL5990_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5990_BP_CODACT(taCODACT5990_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5990_BP_CODCLI(taCODCLI5990_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5990_BP_CODPRO(tCODPRO_Maj)
        R_GEEX5990_BP_VALPRO(taVALPRO5990_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5990_BP_CODPAL(tCODPAL_Maj)
        R_GEEX5990_BP_MOTIMM(taMOTIMM5990_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5990_BP_DATLIB(taDATLIB5990_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5990_BP_HEULIB(taHEULIB5990_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5990_BP_INDLIB(taINDLIB5990_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5990_BP_IMMBKL(taIMMBKL5990_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5990_BP_PALIMM(taPALIMM5990_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5990_BP_DATBKL(taDATBKL5990_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5990_BP_HEUBKL(taHEUBKL5990_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5990_BP_DATIMM(taDATIMM5990_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5990_BP_HEUIMM(taHEUIMM5990_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5990_BP_DISEXC(taDISEXC5990_MASSIF_Line[tNUMSUP_Maj])
        if length(tMOTIMM) = 0 then
            R_GEEX5990_BP_LIBIMO("Released")
        else
            R_GEEX5990_BP_LIBIMO(tLIBVAL)
        endif

        flush(0,0,NL) >> tFileOutTempBP_Massif
    ! FIM LINHA 59.90
endfunction

!==============================================================================

function bfEscreve59detalhe(tREFLIV_Maj, tCODPAL_Maj, tUVCLIV_Maj, tPCBPRO_Maj, tCODLOT_Maj, tDATFVI_Maj, tCODPRO_Maj, tDS1PRO_Maj, tDS2PRO_Maj, tNUMSUP_Maj)
    ! LINHA 59.40  
        R_GEEX5940_BP_CODEXC("59")
        R_GEEX5940_BP_SEPEXC(".")
        R_GEEX5940_BP_SCOEXC("40")
        R_GEEX5940_BP_TRTEXC(taTRTEXC5940_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5940_BP_NUMSUP(taNUMSUP5940_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5940_BP_SNUSUP(taSNUSUP5940_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5940_BP_SEQSUP(taSEQSUP5940_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5940_BP_NUMLIV(taNUMLIV5940_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5940_BP_SNULIV(taSNULIV5940_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5940_BP_SEQLIV(taSEQLIV5940_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5940_BP_TOPLIV(taTOPLIV5940_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5940_BP_CODCLI(taCODCLI5940_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5940_BP_CLILIV(taCLILIV5940_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5940_BP_CODACT(taCODACT5940_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5940_BP_CODPRO(tCODPRO_Maj)
        R_GEEX5940_BP_VALPRO(taVALPRO5940_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5940_BP_VAPPRO(taVAPPRO5940_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5940_BP_DS1PRO(tDS1PRO_Maj)
        R_GEEX5940_BP_DS2PRO(tDS2PRO_Maj)
        R_GEEX5940_BP_FAMPRO(taFAMPRO5940_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5940_BP_ANAPRO(taANAPRO5940_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5940_BP_UNIPRO(taUNIPRO5940_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5940_BP_MESPRO(taMESPRO5940_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5940_BP_PDBCOL(taPDBCOL5940_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5940_BP_VOLCOL(taVOLCOL5940_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5940_BP_COECOL(taCOECOL5940_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5940_BP_CODALC(taCODALC5940_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5940_BP_DEGALC(taDEGALC5940_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5940_BP_VOLALC(taVOLALC5940_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5940_BP_CODEAP(taCODEAP5940_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5940_BP_CODPRN(taCODPRN5940_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5940_BP_EDIPRO(taEDIPRO5940_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5940_BP_UNICDE(taUNICDE5940_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5940_BP_CVTUVC(taCVTUVC5940_MASSIF_Line[tNUMSUP_Maj])

        flush(0,0,NL) >> tFileOutTempBP_Massif
    ! FIM LINHA 59.40

    ! LINHA 59.41
        R_GEEX5941_BP_CODEXC("59")
        R_GEEX5941_BP_SEPEXC(".")
        R_GEEX5941_BP_SCOEXC("41")
        R_GEEX5941_BP_TRTEXC(taTRTEXC5941_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5941_BP_TYPSTK(taTYPSTK5941_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5941_BP_AIGPRI(taAIGPRI5941_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5941_BP_PRILIV(taPRILIV5941_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5941_BP_TYPOPE(taTYPOPE5941_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5941_BP_NUMOPE(taNUMOPE5941_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5941_BP_MSGLIG(taMSGLIG5941_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5941_BP_DIPLIV(taDIPLIV5941_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5941_BP_NLILIV(taNLILIV5941_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5941_BP_PRPPIC(taPRPPIC5941_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5941_BP_ZONPIC(taZONPIC5941_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5941_BP_ALLPIC(taALLPIC5941_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5941_BP_DPLPIC(taDPLPIC5941_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5941_BP_NIVPIC(taNIVPIC5941_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5941_BP_NUMPIC(taNUMPIC5941_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5941_BP_UVCCDE(taUVCCDE5941_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5941_BP_UVCSRV(taUVCSRV5941_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5941_BP_UVCLIV(tUVCLIV_Maj)
        R_GEEX5941_BP_PDNLIV(taPDNLIV5941_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5941_BP_SPCPRO(taSPCPRO5941_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5941_BP_PCBPRO(tPCBPRO_Maj)
        R_GEEX5941_BP_COLCOU(taCOLCOU5941_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5941_BP_COUPAL(taCOUPAL5941_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5941_BP_GERPAL(taGERPAL5941_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5941_BP_GERHAU(taGERHAU5941_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5941_BP_NUMPAL(taNUMPAL5941_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5941_BP_SNUPAL(taSNUPAL5941_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5941_BP_CODPAL(tCODPAL_Maj)
        R_GEEX5941_BP_NUMLOT(taNUMLOT5941_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5941_BP_CODLOT(tCODLOT_Maj)
        R_GEEX5941_BP_DATFVI(tDATFVI_Maj)
        R_GEEX5941_BP_DISEXC(taDISEXC5941_MASSIF_Line[tNUMSUP_Maj])
        
        flush(0,0,NL) >> tFileOutTempBP_Massif
    ! FIM LINHA 59.41
    
    ! LINHA 59.42
        R_GEEX5942_BP_CODEXC("59")
        R_GEEX5942_BP_SEPEXC(".")
        R_GEEX5942_BP_SCOEXC("42")
        R_GEEX5942_BP_TRTEXC(taTRTEXC5942_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5942_BP_ZONSTS(taZONSTS5942_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5942_BP_ALLSTS(taALLSTS5942_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5942_BP_DPLSTS(taDPLSTS5942_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5942_BP_NIVSTS(taNIVSTS5942_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5942_BP_CODACL(taCODACL5942_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5942_BP_MOTMVT(taMOTMVT5942_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5942_BP_ZONORI(taZONORI5942_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5942_BP_ALLORI(taALLORI5942_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5942_BP_DPLORI(taDPLORI5942_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5942_BP_NIVORI(taNIVORI5942_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5942_BP_UVCMNQ(taUVCMNQ5942_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5942_BP_PDNUVC(taPDNUVC5942_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5942_BP_NUMCLS(taNUMCLS5942_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5942_BP_CODCLS(taCODCLS5942_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5942_BP_NUMRPT(taNUMRPT5942_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5942_BP_SNURPT(taSNURPT5942_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5942_BP_TOPRPT(taTOPRPT5942_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5942_BP_COELOG(taCOELOG5942_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5942_BP_CNFLIG(taCNFLIG5942_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5942_BP_UVCDIF(taUVCDIF5942_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5942_BP_PDBUVC(taPDBUVC5942_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5942_BP_REFLIV(tREFLIV_Maj)
        R_GEEX5942_BP_UVCEMB(taUVCEMB5942_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5942_BP_MAJPOI(taMAJPOI5942_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5942_BP_STKOUV(taSTKOUV5942_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5942_BP_CODSUP(taCODSUP5942_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5942_BP_DATFAB(taDATFAB5942_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5942_BP_VLDDAT(taVLDDAT5942_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5942_BP_TOPCOL(taTOPCOL5942_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5942_BP_VTLSEQ(taVTLSEQ5942_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5942_BP_REFORI(taREFORI5942_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5942_BP_CODOPE(taCODOPE5942_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5942_BP_NUMORI(taNUMORI5942_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5942_BP_SNUORI(taSNUORI5942_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5942_BP_DISEXC(taDISEXC5942_MASSIF_Line[tNUMSUP_Maj])

        flush(0,0,NL) >> tFileOutTempBP_Massif
    ! FIM LINHA 59.42

    ! LINHA 59.45
        R_GEEX5945_BP_CODEXC("59")
        R_GEEX5945_BP_SEPEXC(".")
        R_GEEX5945_BP_SCOEXC("45")
        R_GEEX5945_BP_TRTEXC(taTRTEXC5945_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5945_BP_NUMLIV(taNUMLIV5945_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5945_BP_SNULIV(taSNULIV5945_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5945_BP_REFLIV(tREFLIV_Maj)
        R_GEEX5945_BP_NLILIV(taNLILIV5945_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5945_BP_CODACT(taCODACT5945_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5945_BP_CODCLI(taCODCLI5945_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5945_BP_CODPRO(tCODPRO_Maj)
        R_GEEX5945_BP_VALPRO(taVALPRO5945_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5945_BP_DS1PRO(tDS1PRO_Maj)
        R_GEEX5945_BP_DS2PRO(tDS2PRO_Maj)
        R_GEEX5945_BP_DS3PRO(taDS3PRO5945_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5945_BP_FAMPRO(taFAMPRO5945_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5945_BP_DISEXC(taDISEXC5945_MASSIF_Line[tNUMSUP_Maj])

        flush(0,0,NL) >> tFileOutTempBP_Massif
    ! FIM LINHA 59.45

    ! LINHA 59.90
        R_GEEX5990_BP_CODEXC("59")
        R_GEEX5990_BP_SEPEXC(".")
        R_GEEX5990_BP_SCOEXC("90")
        R_GEEX5990_BP_TRTEXC(taTRTEXC5990_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5990_BP_NUMPAL(taNUMPAL5990_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5990_BP_SNUPAL(taSNUPAL5990_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5990_BP_CODACT(taCODACT5990_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5990_BP_CODCLI(taCODCLI5990_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5990_BP_CODPRO(tCODPRO_Maj)
        R_GEEX5990_BP_VALPRO(taVALPRO5990_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5990_BP_CODPAL(tCODPAL_Maj)
        R_GEEX5990_BP_MOTIMM(taMOTIMM5990_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5990_BP_DATLIB(taDATLIB5990_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5990_BP_HEULIB(taHEULIB5990_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5990_BP_INDLIB(taINDLIB5990_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5990_BP_IMMBKL(taIMMBKL5990_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5990_BP_PALIMM(taPALIMM5990_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5990_BP_DATBKL(taDATBKL5990_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5990_BP_HEUBKL(taHEUBKL5990_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5990_BP_DATIMM(taDATIMM5990_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5990_BP_HEUIMM(taHEUIMM5990_MASSIF_Line[tNUMSUP_Maj])
        R_GEEX5990_BP_DISEXC(taDISEXC5990_MASSIF_Line[tNUMSUP_Maj])
        if length(tMOTIMM) = 0 then
            R_GEEX5990_BP_LIBIMO("Released")
        else
            R_GEEX5990_BP_LIBIMO(tLIBVAL)
        endif

        flush(0,0,NL) >> tFileOutTempBP_Massif
    ! FIM LINHA 59.90
endfunction
